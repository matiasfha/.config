"use strict";var d=Object.defineProperty;var D=Object.getOwnPropertyDescriptor;var S=Object.getOwnPropertyNames;var $=Object.prototype.hasOwnProperty;var M=(t,e)=>{for(var r in e)d(t,r,{get:e[r],enumerable:!0})},O=(t,e,r,l)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of S(e))!$.call(t,a)&&a!==r&&d(t,a,{get:()=>e[a],enumerable:!(l=D(e,a))||l.enumerable});return t};var E=t=>O(d({},"__esModule",{value:!0}),t);var N={};M(N,{default:()=>T});module.exports=E(N);var n=require("@raycast/api"),P=require("react");var p=require("@raycast/api"),u=new p.Cache,c="pomodoro-interval/1.1",f=()=>Math.round(new Date().valueOf()/1e3);function v({parts:t}){return t.reduce((e,r)=>(typeof r.pausedAt<"u"?r.pausedAt-r.startedAt:f()-r.startedAt)+e,0)}function g(t){return v(t)/t.length*100}function y({parts:t}){return!!t[t.length-1].pausedAt}function k(t){let e={type:t,length:J[t],parts:[{startedAt:f()}]};return u.set(c,JSON.stringify(e)),e}function b(){let t=m();if(t){let e=[...t.parts];e[e.length-1].pausedAt=f(),t={...t,parts:e},u.set(c,JSON.stringify(t))}return t}function x(){let t=m();if(t){let e=[...t.parts,{startedAt:f()}];t={...t,parts:e},u.set(c,JSON.stringify(t))}return t}function h(){u.remove(c)}function m(){let t=u.get(c);if(t)return JSON.parse(t)}var i=(0,p.getPreferenceValues)(),J={focus:parseInt(i.focusIntervalDuration)*60,"short-break":parseInt(i.shortBreakIntervalDuration)*60,"long-break":parseInt(i.longBreakIntervalDuration)*60};function A(t){if(t<=0)return"00:00";let e=Math.floor(t/60),r=t%60;return`${e<10?`0${e}`:e}:${r<10?`0${r}`:r}`}var o=require("react/jsx-runtime");function T(){let[t,e]=(0,P.useState)(m());if(t&&g(t)>=100){try{(0,n.launchCommand)({name:"pomodoro-control-timer",type:n.LaunchType.UserInitiated,context:{currentInterval:t}})}catch(s){console.error(s)}h()}function r(s){e(k(s))}function l(){e(b())}function a(){e(x())}function C(){h(),e(void 0)}let I;if(I={source:{light:"tomato-light.png",dark:"tomato-dark.png"}},t){let s=Math.floor(g(t)/25)*25;I=n.Icon[s>0?`CircleProgress${s}`:"Circle"]}let B=t?A(t.length-v(t)):"--:--";return(0,o.jsx)(n.MenuBarExtra,{icon:I,title:B,tooltip:"Pomodoro",children:t?(0,o.jsxs)(o.Fragment,{children:[y(t)?(0,o.jsx)(n.MenuBarExtra.Item,{title:"Continue",icon:n.Icon.Play,onAction:a,shortcut:{modifiers:["cmd"],key:"c"}}):(0,o.jsx)(n.MenuBarExtra.Item,{title:"Pause",icon:n.Icon.Pause,onAction:l,shortcut:{modifiers:["cmd"],key:"p"}}),(0,o.jsx)(n.MenuBarExtra.Item,{title:"Reset",icon:n.Icon.Stop,onAction:C,shortcut:{modifiers:["cmd"],key:"r"}})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.MenuBarExtra.Item,{title:"Focus",subtitle:`${i.focusIntervalDuration}:00`,icon:"\u{1F3AF}",onAction:()=>r("focus"),shortcut:{modifiers:["cmd"],key:"f"}}),(0,o.jsx)(n.MenuBarExtra.Item,{title:"Short Break",subtitle:`${i.shortBreakIntervalDuration}:00`,icon:"\u{1F9D8}\u200D\u2642\uFE0F",onAction:()=>r("short-break"),shortcut:{modifiers:["cmd"],key:"s"}}),(0,o.jsx)(n.MenuBarExtra.Item,{title:"Long Break",subtitle:`${i.longBreakIntervalDuration}:00`,icon:"\u{1F6B6}",onAction:()=>r("long-break"),shortcut:{modifiers:["cmd"],key:"l"}})]})})}0&&(module.exports={});
