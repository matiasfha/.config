"use strict";var Hc=Object.create;var an=Object.defineProperty;var Vc=Object.getOwnPropertyDescriptor;var Gc=Object.getOwnPropertyNames;var Yc=Object.getPrototypeOf,Kc=Object.prototype.hasOwnProperty;var cr=(o,t)=>()=>(o&&(t=o(o=0)),t);var Q=(o,t)=>()=>(t||o((t={exports:{}}).exports,t),t.exports),ys=(o,t)=>{for(var n in t)an(o,n,{get:t[n],enumerable:!0})},bs=(o,t,n,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Gc(t))!Kc.call(o,a)&&a!==n&&an(o,a,{get:()=>t[a],enumerable:!(i=Vc(t,a))||i.enumerable});return o};var J=(o,t,n)=>(n=o!=null?Hc(Yc(o)):{},bs(t||!o||!o.__esModule?an(n,"default",{value:o,enumerable:!0}):n,o)),Qc=o=>bs(an({},"__esModule",{value:!0}),o);var Es=Q((Wd,_s)=>{_s.exports=ws;ws.sync=Xc;var gs=require("fs");function Zc(o,t){var n=t.pathExt!==void 0?t.pathExt:process.env.PATHEXT;if(!n||(n=n.split(";"),n.indexOf("")!==-1))return!0;for(var i=0;i<n.length;i++){var a=n[i].toLowerCase();if(a&&o.substr(-a.length).toLowerCase()===a)return!0}return!1}function Ss(o,t,n){return!o.isSymbolicLink()&&!o.isFile()?!1:Zc(t,n)}function ws(o,t,n){gs.stat(o,function(i,a){n(i,i?!1:Ss(a,o,t))})}function Xc(o,t){return Ss(gs.statSync(o),o,t)}});var Is=Q((zd,Ps)=>{Ps.exports=Rs;Rs.sync=Jc;var Ts=require("fs");function Rs(o,t,n){Ts.stat(o,function(i,a){n(i,i?!1:Cs(a,t))})}function Jc(o,t){return Cs(Ts.statSync(o),t)}function Cs(o,t){return o.isFile()&&ef(o,t)}function ef(o,t){var n=o.mode,i=o.uid,a=o.gid,l=t.uid!==void 0?t.uid:process.getuid&&process.getuid(),c=t.gid!==void 0?t.gid:process.getgid&&process.getgid(),y=parseInt("100",8),p=parseInt("010",8),h=parseInt("001",8),b=y|p,S=n&h||n&p&&a===c||n&y&&i===l||n&b&&l===0;return S}});var vs=Q((jd,As)=>{var qd=require("fs"),ln;process.platform==="win32"||global.TESTING_WINDOWS?ln=Es():ln=Is();As.exports=yo;yo.sync=tf;function yo(o,t,n){if(typeof t=="function"&&(n=t,t={}),!n){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(i,a){yo(o,t||{},function(l,c){l?a(l):i(c)})})}ln(o,t||{},function(i,a){i&&(i.code==="EACCES"||t&&t.ignoreErrors)&&(i=null,a=!1),n(i,a)})}function tf(o,t){try{return ln.sync(o,t||{})}catch(n){if(t&&t.ignoreErrors||n.code==="EACCES")return!1;throw n}}});var Fs=Q(($d,Ns)=>{var Wt=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",xs=require("path"),rf=Wt?";":":",Ls=vs(),Os=o=>Object.assign(new Error(`not found: ${o}`),{code:"ENOENT"}),Ds=(o,t)=>{let n=t.colon||rf,i=o.match(/\//)||Wt&&o.match(/\\/)?[""]:[...Wt?[process.cwd()]:[],...(t.path||process.env.PATH||"").split(n)],a=Wt?t.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",l=Wt?a.split(n):[""];return Wt&&o.indexOf(".")!==-1&&l[0]!==""&&l.unshift(""),{pathEnv:i,pathExt:l,pathExtExe:a}},ks=(o,t,n)=>{typeof t=="function"&&(n=t,t={}),t||(t={});let{pathEnv:i,pathExt:a,pathExtExe:l}=Ds(o,t),c=[],y=h=>new Promise((b,S)=>{if(h===i.length)return t.all&&c.length?b(c):S(Os(o));let v=i[h],A=/^".*"$/.test(v)?v.slice(1,-1):v,w=xs.join(A,o),W=!A&&/^\.[\\\/]/.test(o)?o.slice(0,2)+w:w;b(p(W,h,0))}),p=(h,b,S)=>new Promise((v,A)=>{if(S===a.length)return v(y(b+1));let w=a[S];Ls(h+w,{pathExt:l},(W,L)=>{if(!W&&L)if(t.all)c.push(h+w);else return v(h+w);return v(p(h,b,S+1))})});return n?y(0).then(h=>n(null,h),n):y(0)},nf=(o,t)=>{t=t||{};let{pathEnv:n,pathExt:i,pathExtExe:a}=Ds(o,t),l=[];for(let c=0;c<n.length;c++){let y=n[c],p=/^".*"$/.test(y)?y.slice(1,-1):y,h=xs.join(p,o),b=!p&&/^\.[\\\/]/.test(o)?o.slice(0,2)+h:h;for(let S=0;S<i.length;S++){let v=b+i[S];try{if(Ls.sync(v,{pathExt:a}))if(t.all)l.push(v);else return v}catch{}}}if(t.all&&l.length)return l;if(t.nothrow)return null;throw Os(o)};Ns.exports=ks;ks.sync=nf});var Ms=Q((Hd,bo)=>{"use strict";var Bs=(o={})=>{let t=o.env||process.env;return(o.platform||process.platform)!=="win32"?"PATH":Object.keys(t).reverse().find(i=>i.toUpperCase()==="PATH")||"Path"};bo.exports=Bs;bo.exports.default=Bs});var qs=Q((Vd,zs)=>{"use strict";var Us=require("path"),of=Fs(),sf=Ms();function Ws(o,t){let n=o.options.env||process.env,i=process.cwd(),a=o.options.cwd!=null,l=a&&process.chdir!==void 0&&!process.chdir.disabled;if(l)try{process.chdir(o.options.cwd)}catch{}let c;try{c=of.sync(o.command,{path:n[sf({env:n})],pathExt:t?Us.delimiter:void 0})}catch{}finally{l&&process.chdir(i)}return c&&(c=Us.resolve(a?o.options.cwd:"",c)),c}function af(o){return Ws(o)||Ws(o,!0)}zs.exports=af});var js=Q((Gd,So)=>{"use strict";var go=/([()\][%!^"`<>&|;, *?])/g;function lf(o){return o=o.replace(go,"^$1"),o}function uf(o,t){return o=`${o}`,o=o.replace(/(\\*)"/g,'$1$1\\"'),o=o.replace(/(\\*)$/,"$1$1"),o=`"${o}"`,o=o.replace(go,"^$1"),t&&(o=o.replace(go,"^$1")),o}So.exports.command=lf;So.exports.argument=uf});var Hs=Q((Yd,$s)=>{"use strict";$s.exports=/^#!(.*)/});var Gs=Q((Kd,Vs)=>{"use strict";var cf=Hs();Vs.exports=(o="")=>{let t=o.match(cf);if(!t)return null;let[n,i]=t[0].replace(/#! ?/,"").split(" "),a=n.split("/").pop();return a==="env"?i:i?`${a} ${i}`:a}});var Ks=Q((Qd,Ys)=>{"use strict";var wo=require("fs"),ff=Gs();function df(o){let n=Buffer.alloc(150),i;try{i=wo.openSync(o,"r"),wo.readSync(i,n,0,150,0),wo.closeSync(i)}catch{}return ff(n.toString())}Ys.exports=df});var Js=Q((Zd,Xs)=>{"use strict";var hf=require("path"),Qs=qs(),Zs=js(),mf=Ks(),pf=process.platform==="win32",yf=/\.(?:com|exe)$/i,bf=/node_modules[\\/].bin[\\/][^\\/]+\.cmd$/i;function gf(o){o.file=Qs(o);let t=o.file&&mf(o.file);return t?(o.args.unshift(o.file),o.command=t,Qs(o)):o.file}function Sf(o){if(!pf)return o;let t=gf(o),n=!yf.test(t);if(o.options.forceShell||n){let i=bf.test(t);o.command=hf.normalize(o.command),o.command=Zs.command(o.command),o.args=o.args.map(l=>Zs.argument(l,i));let a=[o.command].concat(o.args).join(" ");o.args=["/d","/s","/c",`"${a}"`],o.command=process.env.comspec||"cmd.exe",o.options.windowsVerbatimArguments=!0}return o}function wf(o,t,n){t&&!Array.isArray(t)&&(n=t,t=null),t=t?t.slice(0):[],n=Object.assign({},n);let i={command:o,args:t,options:n,file:void 0,original:{command:o,args:t}};return n.shell?i:Sf(i)}Xs.exports=wf});var ra=Q((Xd,ta)=>{"use strict";var _o=process.platform==="win32";function Eo(o,t){return Object.assign(new Error(`${t} ${o.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${t} ${o.command}`,path:o.command,spawnargs:o.args})}function _f(o,t){if(!_o)return;let n=o.emit;o.emit=function(i,a){if(i==="exit"){let l=ea(a,t,"spawn");if(l)return n.call(o,"error",l)}return n.apply(o,arguments)}}function ea(o,t){return _o&&o===1&&!t.file?Eo(t.original,"spawn"):null}function Ef(o,t){return _o&&o===1&&!t.file?Eo(t.original,"spawnSync"):null}ta.exports={hookChildProcess:_f,verifyENOENT:ea,verifyENOENTSync:Ef,notFoundError:Eo}});var ia=Q((Jd,zt)=>{"use strict";var na=require("child_process"),To=Js(),Ro=ra();function oa(o,t,n){let i=To(o,t,n),a=na.spawn(i.command,i.args,i.options);return Ro.hookChildProcess(a,i),a}function Tf(o,t,n){let i=To(o,t,n),a=na.spawnSync(i.command,i.args,i.options);return a.error=a.error||Ro.verifyENOENTSync(a.status,i),a}zt.exports=oa;zt.exports.spawn=oa;zt.exports.sync=Tf;zt.exports._parse=To;zt.exports._enoent=Ro});var ga=Q((gh,dn)=>{dn.exports=["SIGABRT","SIGALRM","SIGHUP","SIGINT","SIGTERM"];process.platform!=="win32"&&dn.exports.push("SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT");process.platform==="linux"&&dn.exports.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT","SIGUNUSED")});var Ta=Q((Sh,Ht)=>{var Y=global.process,gt=function(o){return o&&typeof o=="object"&&typeof o.removeListener=="function"&&typeof o.emit=="function"&&typeof o.reallyExit=="function"&&typeof o.listeners=="function"&&typeof o.kill=="function"&&typeof o.pid=="number"&&typeof o.on=="function"};gt(Y)?(Sa=require("assert"),jt=ga(),wa=/^win/i.test(Y.platform),hr=require("events"),typeof hr!="function"&&(hr=hr.EventEmitter),Y.__signal_exit_emitter__?te=Y.__signal_exit_emitter__:(te=Y.__signal_exit_emitter__=new hr,te.count=0,te.emitted={}),te.infinite||(te.setMaxListeners(1/0),te.infinite=!0),Ht.exports=function(o,t){if(!gt(global.process))return function(){};Sa.equal(typeof o,"function","a callback must be provided for exit handler"),$t===!1&&Ao();var n="exit";t&&t.alwaysLast&&(n="afterexit");var i=function(){te.removeListener(n,o),te.listeners("exit").length===0&&te.listeners("afterexit").length===0&&hn()};return te.on(n,o),i},hn=function(){!$t||!gt(global.process)||($t=!1,jt.forEach(function(t){try{Y.removeListener(t,mn[t])}catch{}}),Y.emit=pn,Y.reallyExit=vo,te.count-=1)},Ht.exports.unload=hn,St=function(t,n,i){te.emitted[t]||(te.emitted[t]=!0,te.emit(t,n,i))},mn={},jt.forEach(function(o){mn[o]=function(){if(gt(global.process)){var n=Y.listeners(o);n.length===te.count&&(hn(),St("exit",null,o),St("afterexit",null,o),wa&&o==="SIGHUP"&&(o="SIGINT"),Y.kill(Y.pid,o))}}}),Ht.exports.signals=function(){return jt},$t=!1,Ao=function(){$t||!gt(global.process)||($t=!0,te.count+=1,jt=jt.filter(function(t){try{return Y.on(t,mn[t]),!0}catch{return!1}}),Y.emit=Ea,Y.reallyExit=_a)},Ht.exports.load=Ao,vo=Y.reallyExit,_a=function(t){gt(global.process)&&(Y.exitCode=t||0,St("exit",Y.exitCode,null),St("afterexit",Y.exitCode,null),vo.call(Y,Y.exitCode))},pn=Y.emit,Ea=function(t,n){if(t==="exit"&&gt(global.process)){n!==void 0&&(Y.exitCode=n);var i=pn.apply(this,arguments);return St("exit",Y.exitCode,null),St("afterexit",Y.exitCode,null),i}else return pn.apply(this,arguments)}):Ht.exports=function(){return function(){}};var Sa,jt,wa,hr,te,hn,St,mn,$t,Ao,vo,_a,pn,Ea});var Oa=Q((Eh,La)=>{"use strict";var{PassThrough:Gf}=require("stream");La.exports=o=>{o={...o};let{array:t}=o,{encoding:n}=o,i=n==="buffer",a=!1;t?a=!(n||i):n=n||"utf8",i&&(n=null);let l=new Gf({objectMode:a});n&&l.setEncoding(n);let c=0,y=[];return l.on("data",p=>{y.push(p),a?c=y.length:c+=p.length}),l.getBufferedValue=()=>t?y:i?Buffer.concat(y,c):y.join(""),l.getBufferedLength=()=>c,l}});var Da=Q((Th,mr)=>{"use strict";var{constants:Yf}=require("buffer"),Kf=require("stream"),{promisify:Qf}=require("util"),Zf=Oa(),Xf=Qf(Kf.pipeline),yn=class extends Error{constructor(){super("maxBuffer exceeded"),this.name="MaxBufferError"}};async function Lo(o,t){if(!o)throw new Error("Expected a stream");t={maxBuffer:1/0,...t};let{maxBuffer:n}=t,i=Zf(t);return await new Promise((a,l)=>{let c=y=>{y&&i.getBufferedLength()<=Yf.MAX_LENGTH&&(y.bufferedData=i.getBufferedValue()),l(y)};(async()=>{try{await Xf(o,i),a()}catch(y){c(y)}})(),i.on("data",()=>{i.getBufferedLength()>n&&c(new yn)})}),i.getBufferedValue()}mr.exports=Lo;mr.exports.buffer=(o,t)=>Lo(o,{...t,encoding:"buffer"});mr.exports.array=(o,t)=>Lo(o,{...t,array:!0});mr.exports.MaxBufferError=yn});var Na=Q((Rh,ka)=>{"use strict";var{PassThrough:Jf}=require("stream");ka.exports=function(){var o=[],t=new Jf({objectMode:!0});return t.setMaxListeners(0),t.add=n,t.isEmpty=i,t.on("unpipe",a),Array.prototype.slice.call(arguments).forEach(n),t;function n(l){return Array.isArray(l)?(l.forEach(n),this):(o.push(l),l.once("end",a.bind(null,l)),l.once("error",t.emit.bind(t,"error")),l.pipe(t,{end:!1}),this)}function i(){return o.length==0}function a(l){o=o.filter(function(c){return c!==l}),!o.length&&t.readable&&t.end()}}});var sl=Q((um,il)=>{var ge=require("fs"),fd=require("util"),Gt=require("path"),Ho=require("events"),tl=require("zlib"),ol=require("stream"),_={LOCHDR:30,LOCSIG:67324752,LOCVER:4,LOCFLG:6,LOCHOW:8,LOCTIM:10,LOCCRC:14,LOCSIZ:18,LOCLEN:22,LOCNAM:26,LOCEXT:28,EXTSIG:134695760,EXTHDR:16,EXTCRC:4,EXTSIZ:8,EXTLEN:12,CENHDR:46,CENSIG:33639248,CENVEM:4,CENVER:6,CENFLG:8,CENHOW:10,CENTIM:12,CENCRC:16,CENSIZ:20,CENLEN:24,CENNAM:28,CENEXT:30,CENCOM:32,CENDSK:34,CENATT:36,CENATX:38,CENOFF:42,ENDHDR:22,ENDSIG:101010256,ENDSIGFIRST:80,ENDSUB:8,ENDTOT:10,ENDSIZ:12,ENDOFF:16,ENDCOM:20,MAXFILECOMMENT:65535,ENDL64HDR:20,ENDL64SIG:117853008,ENDL64SIGFIRST:80,ENDL64OFS:8,END64HDR:56,END64SIG:101075792,END64SIGFIRST:80,END64SUB:24,END64TOT:32,END64SIZ:40,END64OFF:48,STORED:0,SHRUNK:1,REDUCED1:2,REDUCED2:3,REDUCED3:4,REDUCED4:5,IMPLODED:6,DEFLATED:8,ENHANCED_DEFLATED:9,PKWARE:10,BZIP2:12,LZMA:14,IBM_TERSE:18,IBM_LZ77:19,FLG_ENC:0,FLG_COMP1:1,FLG_COMP2:2,FLG_DESC:4,FLG_ENH:8,FLG_STR:16,FLG_LNG:1024,FLG_MSK:4096,FLG_ENTRY_ENC:1,EF_ID:0,EF_SIZE:2,ID_ZIP64:1,ID_AVINFO:7,ID_PFS:8,ID_OS2:9,ID_NTFS:10,ID_OPENVMS:12,ID_UNIX:13,ID_FORK:14,ID_PATCH:15,ID_X509_PKCS7:20,ID_X509_CERTID_F:21,ID_X509_CERTID_C:22,ID_STRONGENC:23,ID_RECORD_MGT:24,ID_X509_PKCS7_RL:25,ID_IBM1:101,ID_IBM2:102,ID_POSZIP:18064,EF_ZIP64_OR_32:4294967295,EF_ZIP64_OR_16:65535},nt=function(o){let t,n,i,a,l,c,p=this,h=o.storeEntries!==!1?{}:null,b=o.file,S=o.nameEncoding?new TextDecoder(o.nameEncoding):null;v();function v(){o.fd?(t=o.fd,A()):ge.open(b,"r",(g,E)=>{if(g)return p.emit("error",g);t=E,A()})}function A(){ge.fstat(t,(g,E)=>{if(g)return p.emit("error",g);n=E.size,i=o.chunkSize||Math.round(n/1e3),i=Math.max(Math.min(i,Math.min(128*1024,n)),Math.min(1024,n)),W()})}function w(g,E){if(g||!E)return p.emit("error",g||new Error("Archive read error"));let C=a.lastPos,R=C-a.win.position,U=a.win.buffer,B=a.minPos;for(;--C>=B&&--R>=0;)if(U.length-R>=4&&U[R]===a.firstByte&&U.readUInt32LE(R)===a.sig){a.lastBufferPosition=R,a.lastBytesRead=E,a.complete();return}if(C===B)return p.emit("error",new Error("Bad archive"));if(a.lastPos=C+1,a.chunkSize*=2,C<=B)return p.emit("error",new Error("Bad archive"));let G=Math.min(a.chunkSize,C-B);a.win.expandLeft(G,w)}function W(){let g=Math.min(_.ENDHDR+_.MAXFILECOMMENT,n);a={win:new _n(t),totalReadLength:g,minPos:n-g,lastPos:n,chunkSize:Math.min(1024,i),firstByte:_.ENDSIGFIRST,sig:_.ENDSIG,complete:L},a.win.read(n-a.chunkSize,a.chunkSize,w)}function L(){let g=a.win.buffer,E=a.lastBufferPosition;try{l=new Uo,l.read(g.slice(E,E+_.ENDHDR)),l.headerOffset=a.win.position+E,l.commentLength?p.comment=g.slice(E+_.ENDHDR,E+_.ENDHDR+l.commentLength).toString():p.comment=null,p.entriesCount=l.volumeEntries,p.centralDirectory=l,l.volumeEntries===_.EF_ZIP64_OR_16&&l.totalEntries===_.EF_ZIP64_OR_16||l.size===_.EF_ZIP64_OR_32||l.offset===_.EF_ZIP64_OR_32?k():(a={},D())}catch(C){p.emit("error",C)}}function k(){let g=_.ENDL64HDR;a.lastBufferPosition>g?(a.lastBufferPosition-=g,z()):(a={win:a.win,totalReadLength:g,minPos:a.win.position-g,lastPos:a.win.position,chunkSize:a.chunkSize,firstByte:_.ENDL64SIGFIRST,sig:_.ENDL64SIG,complete:z},a.win.read(a.lastPos-a.chunkSize,a.chunkSize,w))}function z(){let g=a.win.buffer,E=new Wo;E.read(g.slice(a.lastBufferPosition,a.lastBufferPosition+_.ENDL64HDR));let C=n-E.headerOffset;a={win:a.win,totalReadLength:C,minPos:E.headerOffset,lastPos:a.lastPos,chunkSize:a.chunkSize,firstByte:_.END64SIGFIRST,sig:_.END64SIG,complete:X},a.win.read(n-a.chunkSize,a.chunkSize,w)}function X(){let g=a.win.buffer,E=new zo;E.read(g.slice(a.lastBufferPosition,a.lastBufferPosition+_.END64HDR)),p.centralDirectory.volumeEntries=E.volumeEntries,p.centralDirectory.totalEntries=E.totalEntries,p.centralDirectory.size=E.size,p.centralDirectory.offset=E.offset,p.entriesCount=E.volumeEntries,a={},D()}function D(){a={win:new _n(t),pos:l.offset,chunkSize:i,entriesLeft:l.volumeEntries},a.win.read(a.pos,Math.min(i,n-a.pos),V)}function V(g,E){if(g||!E)return p.emit("error",g||new Error("Entries read error"));let C=a.pos-a.win.position,R=a.entry,U=a.win.buffer,B=U.length;try{for(;a.entriesLeft>0;){R||(R=new qo,R.readHeader(U,C),R.headerOffset=a.win.position+C,a.entry=R,a.pos+=_.CENHDR,C+=_.CENHDR);let G=R.fnameLen+R.extraLen+R.comLen,K=G+(a.entriesLeft>1?_.CENHDR:0);if(B-C<K){a.win.moveRight(i,V,C),a.move=!0;return}R.read(U,C,S),o.skipEntryNameValidation||R.validateName(),h&&(h[R.name]=R),p.emit("entry",R),a.entry=R=null,a.entriesLeft--,a.pos+=G,C+=G}p.emit("ready")}catch(G){p.emit("error",G)}}function N(){if(!h)throw new Error("storeEntries disabled")}Object.defineProperty(this,"ready",{get(){return!1}}),this.entry=function(g){return N(),h[g]},this.entries=function(){return N(),h},this.stream=function(g,E){return this.openEntry(g,(C,R)=>{if(C)return E(C);let U=ie(R),B=new jo(t,U,R.compressedSize);if(R.method!==_.STORED)if(R.method===_.DEFLATED)B=B.pipe(tl.createInflateRaw());else return E(new Error("Unknown compression method: "+R.method));st(R)&&(B=B.pipe(new $o(B,R.crc,R.size))),E(null,B)},!1)},this.entryDataSync=function(g){let E=null;if(this.openEntry(g,(R,U)=>{E=R,g=U},!0),E)throw E;let C=Buffer.alloc(g.compressedSize);if(new tt(t,C,0,g.compressedSize,ie(g),R=>{E=R}).read(!0),E)throw E;if(g.method!==_.STORED)if(g.method===_.DEFLATED||g.method===_.ENHANCED_DEFLATED)C=tl.inflateRawSync(C);else throw new Error("Unknown compression method: "+g.method);if(C.length!==g.size)throw new Error("Invalid size");return st(g)&&new En(g.crc,g.size).data(C),C},this.openEntry=function(g,E,C){if(typeof g=="string"&&(N(),g=h[g],!g))return E(new Error("Entry not found"));if(!g.isFile)return E(new Error("Entry is not file"));if(!t)return E(new Error("Archive closed"));let R=Buffer.alloc(_.LOCHDR);new tt(t,R,0,R.length,g.offset,U=>{if(U)return E(U);let B;try{g.readDataHeader(R),g.encrypted&&(B=new Error("Entry encrypted"))}catch(G){B=G}E(B,g)}).read(C)};function ie(g){return g.offset+_.LOCHDR+g.fnameLen+g.extraLen}function st(g){return(g.flags&8)!==8}function at(g,E,C){p.stream(g,(R,U)=>{if(R)C(R);else{let B,G;U.on("error",K=>{G=K,B&&(U.unpipe(B),B.close(()=>{C(K)}))}),ge.open(E,"w",(K,se)=>{if(K)return C(K);if(G){ge.close(t,()=>{C(G)});return}B=ge.createWriteStream(E,{fd:se}),B.on("finish",()=>{p.emit("extract",g,E),G||C()}),U.pipe(B)})}})}function It(g,E,C){if(!E.length)return C();let R=E.shift();R=Gt.join(g,Gt.join(...R)),ge.mkdir(R,{recursive:!0},U=>{if(U&&U.code!=="EEXIST")return C(U);It(g,E,C)})}function lt(g,E,C,R,U){if(!C.length)return R(null,U);let B=C.shift(),G=Gt.join(g,B.name.replace(E,""));at(B,G,K=>{if(K)return R(K,U);lt(g,E,C,R,U+1)})}this.extract=function(g,E,C){let R=g||"";if(typeof g=="string"&&(g=this.entry(g),g?R=g.name:R.length&&R[R.length-1]!=="/"&&(R+="/")),!g||g.isDirectory){let U=[],B=[],G={};for(let K in h)if(Object.prototype.hasOwnProperty.call(h,K)&&K.lastIndexOf(R,0)===0){let se=K.replace(R,""),Jt=h[K];if(Jt.isFile&&(U.push(Jt),se=Gt.dirname(se)),se&&!G[se]&&se!=="."){G[se]=!0;let Pe=se.split("/").filter(ut=>ut);for(Pe.length&&B.push(Pe);Pe.length>1;){Pe=Pe.slice(0,Pe.length-1);let ut=Pe.join("/");if(G[ut]||ut===".")break;G[ut]=!0,B.push(Pe)}}}B.sort((K,se)=>K.length-se.length),B.length?It(E,B,K=>{K?C(K):lt(E,R,U,C,0)}):lt(E,R,U,C,0)}else ge.stat(E,(U,B)=>{B&&B.isDirectory()?at(g,Gt.join(E,Gt.basename(g.name)),C):at(g,E,C)})},this.close=function(g){c||!t?(c=!0,g&&g()):(c=!0,ge.close(t,E=>{t=null,g&&g(E)}))};let xr=Ho.EventEmitter.prototype.emit;this.emit=function(...g){if(!c)return xr.call(this,...g)}};nt.setFs=function(o){ge=o};nt.debugLog=(...o)=>{nt.debug&&console.log(...o)};fd.inherits(nt,Ho.EventEmitter);var et=Symbol("zip");nt.async=class extends Ho.EventEmitter{constructor(t){super();let n=new nt(t);n.on("entry",i=>this.emit("entry",i)),n.on("extract",(i,a)=>this.emit("extract",i,a)),this[et]=new Promise((i,a)=>{n.on("ready",()=>{n.removeListener("error",a),i(n)}),n.on("error",a)})}get entriesCount(){return this[et].then(t=>t.entriesCount)}get comment(){return this[et].then(t=>t.comment)}async entry(t){return(await this[et]).entry(t)}async entries(){return(await this[et]).entries()}async stream(t){let n=await this[et];return new Promise((i,a)=>{n.stream(t,(l,c)=>{l?a(l):i(c)})})}async entryData(t){let n=await this.stream(t);return new Promise((i,a)=>{let l=[];n.on("data",c=>l.push(c)),n.on("end",()=>{i(Buffer.concat(l))}),n.on("error",c=>{n.removeAllListeners("end"),a(c)})})}async extract(t,n){let i=await this[et];return new Promise((a,l)=>{i.extract(t,n,(c,y)=>{c?l(c):a(y)})})}async close(){let t=await this[et];return new Promise((n,i)=>{t.close(a=>{a?i(a):n()})})}};var Uo=class{read(t){if(t.length!==_.ENDHDR||t.readUInt32LE(0)!==_.ENDSIG)throw new Error("Invalid central directory");this.volumeEntries=t.readUInt16LE(_.ENDSUB),this.totalEntries=t.readUInt16LE(_.ENDTOT),this.size=t.readUInt32LE(_.ENDSIZ),this.offset=t.readUInt32LE(_.ENDOFF),this.commentLength=t.readUInt16LE(_.ENDCOM)}},Wo=class{read(t){if(t.length!==_.ENDL64HDR||t.readUInt32LE(0)!==_.ENDL64SIG)throw new Error("Invalid zip64 central directory locator");this.headerOffset=rt(t,_.ENDSUB)}},zo=class{read(t){if(t.length!==_.END64HDR||t.readUInt32LE(0)!==_.END64SIG)throw new Error("Invalid central directory");this.volumeEntries=rt(t,_.END64SUB),this.totalEntries=rt(t,_.END64TOT),this.size=rt(t,_.END64SIZ),this.offset=rt(t,_.END64OFF)}},qo=class{readHeader(t,n){if(t.length<n+_.CENHDR||t.readUInt32LE(n)!==_.CENSIG)throw new Error("Invalid entry header");this.verMade=t.readUInt16LE(n+_.CENVEM),this.version=t.readUInt16LE(n+_.CENVER),this.flags=t.readUInt16LE(n+_.CENFLG),this.method=t.readUInt16LE(n+_.CENHOW);let i=t.readUInt16LE(n+_.CENTIM),a=t.readUInt16LE(n+_.CENTIM+2);this.time=rl(i,a),this.crc=t.readUInt32LE(n+_.CENCRC),this.compressedSize=t.readUInt32LE(n+_.CENSIZ),this.size=t.readUInt32LE(n+_.CENLEN),this.fnameLen=t.readUInt16LE(n+_.CENNAM),this.extraLen=t.readUInt16LE(n+_.CENEXT),this.comLen=t.readUInt16LE(n+_.CENCOM),this.diskStart=t.readUInt16LE(n+_.CENDSK),this.inattr=t.readUInt16LE(n+_.CENATT),this.attr=t.readUInt32LE(n+_.CENATX),this.offset=t.readUInt32LE(n+_.CENOFF)}readDataHeader(t){if(t.readUInt32LE(0)!==_.LOCSIG)throw new Error("Invalid local header");this.version=t.readUInt16LE(_.LOCVER),this.flags=t.readUInt16LE(_.LOCFLG),this.method=t.readUInt16LE(_.LOCHOW);let n=t.readUInt16LE(_.LOCTIM),i=t.readUInt16LE(_.LOCTIM+2);this.time=rl(n,i),this.crc=t.readUInt32LE(_.LOCCRC)||this.crc;let a=t.readUInt32LE(_.LOCSIZ);a&&a!==_.EF_ZIP64_OR_32&&(this.compressedSize=a);let l=t.readUInt32LE(_.LOCLEN);l&&l!==_.EF_ZIP64_OR_32&&(this.size=l),this.fnameLen=t.readUInt16LE(_.LOCNAM),this.extraLen=t.readUInt16LE(_.LOCEXT)}read(t,n,i){let a=t.slice(n,n+=this.fnameLen);this.name=i?i.decode(new Uint8Array(a)):a.toString("utf8");let l=t[n-1];this.isDirectory=l===47||l===92,this.extraLen&&(this.readExtra(t,n),n+=this.extraLen),this.comment=this.comLen?t.slice(n,n+this.comLen).toString():null}validateName(){if(/\\|^\w+:|^\/|(^|\/)\.\.(\/|$)/.test(this.name))throw new Error("Malicious entry: "+this.name)}readExtra(t,n){let i,a,l=n+this.extraLen;for(;n<l;)i=t.readUInt16LE(n),n+=2,a=t.readUInt16LE(n),n+=2,_.ID_ZIP64===i&&this.parseZip64Extra(t,n,a),n+=a}parseZip64Extra(t,n,i){i>=8&&this.size===_.EF_ZIP64_OR_32&&(this.size=rt(t,n),n+=8,i-=8),i>=8&&this.compressedSize===_.EF_ZIP64_OR_32&&(this.compressedSize=rt(t,n),n+=8,i-=8),i>=8&&this.offset===_.EF_ZIP64_OR_32&&(this.offset=rt(t,n),n+=8,i-=8),i>=4&&this.diskStart===_.EF_ZIP64_OR_16&&(this.diskStart=t.readUInt32LE(n))}get encrypted(){return(this.flags&_.FLG_ENTRY_ENC)===_.FLG_ENTRY_ENC}get isFile(){return!this.isDirectory}},tt=class{constructor(t,n,i,a,l,c){this.fd=t,this.buffer=n,this.offset=i,this.length=a,this.position=l,this.callback=c,this.bytesRead=0,this.waiting=!1}read(t){nt.debugLog("read",this.position,this.bytesRead,this.length,this.offset),this.waiting=!0;let n;if(t){let i=0;try{i=ge.readSync(this.fd,this.buffer,this.offset+this.bytesRead,this.length-this.bytesRead,this.position+this.bytesRead)}catch(a){n=a}this.readCallback(t,n,n?i:null)}else ge.read(this.fd,this.buffer,this.offset+this.bytesRead,this.length-this.bytesRead,this.position+this.bytesRead,this.readCallback.bind(this,t))}readCallback(t,n,i){if(typeof i=="number"&&(this.bytesRead+=i),n||!i||this.bytesRead===this.length)return this.waiting=!1,this.callback(n,this.bytesRead);this.read(t)}},_n=class{constructor(t){this.position=0,this.buffer=Buffer.alloc(0),this.fd=t,this.fsOp=null}checkOp(){if(this.fsOp&&this.fsOp.waiting)throw new Error("Operation in progress")}read(t,n,i){this.checkOp(),this.buffer.length<n&&(this.buffer=Buffer.alloc(n)),this.position=t,this.fsOp=new tt(this.fd,this.buffer,0,n,this.position,i).read()}expandLeft(t,n){this.checkOp(),this.buffer=Buffer.concat([Buffer.alloc(t),this.buffer]),this.position-=t,this.position<0&&(this.position=0),this.fsOp=new tt(this.fd,this.buffer,0,t,this.position,n).read()}expandRight(t,n){this.checkOp();let i=this.buffer.length;this.buffer=Buffer.concat([this.buffer,Buffer.alloc(t)]),this.fsOp=new tt(this.fd,this.buffer,i,t,this.position+i,n).read()}moveRight(t,n,i){this.checkOp(),i?this.buffer.copy(this.buffer,0,i):i=0,this.position+=i,this.fsOp=new tt(this.fd,this.buffer,this.buffer.length-i,i,this.position+this.buffer.length-i,n).read()}},jo=class extends ol.Readable{constructor(t,n,i){super(),this.fd=t,this.offset=n,this.length=i,this.pos=0,this.readCallback=this.readCallback.bind(this)}_read(t){let n=Buffer.alloc(Math.min(t,this.length-this.pos));n.length?ge.read(this.fd,n,0,n.length,this.offset+this.pos,this.readCallback):this.push(null)}readCallback(t,n,i){this.pos+=n,t?(this.emit("error",t),this.push(null)):n?(n!==i.length&&(i=i.slice(0,n)),this.push(i)):this.push(null)}},$o=class extends ol.Transform{constructor(t,n,i){super(),this.verify=new En(n,i),t.on("error",a=>{this.emit("error",a)})}_transform(t,n,i){let a;try{this.verify.data(t)}catch(l){a=l}i(a,t)}},En=class o{constructor(t,n){this.crc=t,this.size=n,this.state={crc:-1,size:0}}data(t){let n=o.getCrcTable(),i=this.state.crc,a=0,l=t.length;for(;--l>=0;)i=n[(i^t[a++])&255]^i>>>8;if(this.state.crc=i,this.state.size+=t.length,this.state.size>=this.size){let c=Buffer.alloc(4);if(c.writeInt32LE(~this.state.crc&4294967295,0),i=c.readUInt32LE(0),i!==this.crc)throw new Error("Invalid CRC");if(this.state.size!==this.size)throw new Error("Invalid size")}}static getCrcTable(){let t=o.crcTable;if(!t){o.crcTable=t=[];let n=Buffer.alloc(4);for(let i=0;i<256;i++){let a=i;for(let l=8;--l>=0;)a&1?a=3988292384^a>>>1:a=a>>>1;a<0&&(n.writeInt32LE(a,0),a=n.readUInt32LE(0)),t[i]=a}}return t}};function rl(o,t){let n=nl(o,16),i=nl(t,16),a={h:parseInt(n.slice(0,5).join(""),2),m:parseInt(n.slice(5,11).join(""),2),s:parseInt(n.slice(11,16).join(""),2)*2,Y:parseInt(i.slice(0,7).join(""),2)+1980,M:parseInt(i.slice(7,11).join(""),2),D:parseInt(i.slice(11,16).join(""),2)},l=[a.Y,a.M,a.D].join("-")+" "+[a.h,a.m,a.s].join(":")+" GMT+0";return new Date(l).getTime()}function nl(o,t){let n=(o>>>0).toString(2);for(;n.length<t;)n="0"+n;return n.split("")}function rt(o,t){return o.readUInt32LE(t+4)*4294967296+o.readUInt32LE(t)}il.exports=nt});var gl=Q((Rn,bl)=>{(function(o,t){typeof Rn=="object"&&typeof bl<"u"?t(Rn):typeof define=="function"&&define.amd?define(["exports"],t):(o=typeof globalThis<"u"?globalThis:o||self,t(o.WebStreamsPolyfill={}))})(Rn,function(o){"use strict";let t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol:e=>`Symbol(${e})`;function n(){}function i(e){return typeof e=="object"&&e!==null||typeof e=="function"}let a=n;function l(e,r){try{Object.defineProperty(e,"name",{value:r,configurable:!0})}catch{}}let c=Promise,y=Promise.prototype.then,p=Promise.reject.bind(c);function h(e){return new c(e)}function b(e){return h(r=>r(e))}function S(e){return p(e)}function v(e,r,s){return y.call(e,r,s)}function A(e,r,s){v(v(e,r,s),void 0,a)}function w(e,r){A(e,r)}function W(e,r){A(e,void 0,r)}function L(e,r,s){return v(e,r,s)}function k(e){v(e,void 0,a)}let z=e=>{if(typeof queueMicrotask=="function")z=queueMicrotask;else{let r=b(void 0);z=s=>v(r,s)}return z(e)};function X(e,r,s){if(typeof e!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,r,s)}function D(e,r,s){try{return b(X(e,r,s))}catch(u){return S(u)}}let V=16384;class N{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(r){let s=this._back,u=s;s._elements.length===V-1&&(u={_elements:[],_next:void 0}),s._elements.push(r),u!==s&&(this._back=u,s._next=u),++this._size}shift(){let r=this._front,s=r,u=this._cursor,f=u+1,d=r._elements,m=d[u];return f===V&&(s=r._next,f=0),--this._size,this._cursor=f,r!==s&&(this._front=s),d[u]=void 0,m}forEach(r){let s=this._cursor,u=this._front,f=u._elements;for(;(s!==f.length||u._next!==void 0)&&!(s===f.length&&(u=u._next,f=u._elements,s=0,f.length===0));)r(f[s]),++s}peek(){let r=this._front,s=this._cursor;return r._elements[s]}}let ie=t("[[AbortSteps]]"),st=t("[[ErrorSteps]]"),at=t("[[CancelSteps]]"),It=t("[[PullSteps]]"),lt=t("[[ReleaseSteps]]");function xr(e,r){e._ownerReadableStream=r,r._reader=e,r._state==="readable"?R(e):r._state==="closed"?B(e):U(e,r._storedError)}function g(e,r){let s=e._ownerReadableStream;return Te(s,r)}function E(e){let r=e._ownerReadableStream;r._state==="readable"?G(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):K(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),r._readableStreamController[lt](),r._reader=void 0,e._ownerReadableStream=void 0}function C(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function R(e){e._closedPromise=h((r,s)=>{e._closedPromise_resolve=r,e._closedPromise_reject=s})}function U(e,r){R(e),G(e,r)}function B(e){R(e),se(e)}function G(e,r){e._closedPromise_reject!==void 0&&(k(e._closedPromise),e._closedPromise_reject(r),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function K(e,r){U(e,r)}function se(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}let Jt=Number.isFinite||function(e){return typeof e=="number"&&isFinite(e)},Pe=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function ut(e){return typeof e=="object"||typeof e=="function"}function Ie(e,r){if(e!==void 0&&!ut(e))throw new TypeError(`${r} is not an object.`)}function pe(e,r){if(typeof e!="function")throw new TypeError(`${r} is not a function.`)}function su(e){return typeof e=="object"&&e!==null||typeof e=="function"}function ni(e,r){if(!su(e))throw new TypeError(`${r} is not an object.`)}function De(e,r,s){if(e===void 0)throw new TypeError(`Parameter ${r} is required in '${s}'.`)}function Mn(e,r,s){if(e===void 0)throw new TypeError(`${r} is required in '${s}'.`)}function Un(e){return Number(e)}function oi(e){return e===0?0:e}function au(e){return oi(Pe(e))}function Wn(e,r){let u=Number.MAX_SAFE_INTEGER,f=Number(e);if(f=oi(f),!Jt(f))throw new TypeError(`${r} is not a finite number`);if(f=au(f),f<0||f>u)throw new TypeError(`${r} is outside the accepted range of 0 to ${u}, inclusive`);return!Jt(f)||f===0?0:f}function zn(e,r){if(!Ke(e))throw new TypeError(`${r} is not a ReadableStream.`)}function At(e){return new je(e)}function ii(e,r){e._reader._readRequests.push(r)}function qn(e,r,s){let f=e._reader._readRequests.shift();s?f._closeSteps():f._chunkSteps(r)}function Lr(e){return e._reader._readRequests.length}function si(e){let r=e._reader;return!(r===void 0||!$e(r))}class je{constructor(r){if(De(r,1,"ReadableStreamDefaultReader"),zn(r,"First parameter"),Qe(r))throw new TypeError("This stream has already been locked for exclusive reading by another reader");xr(this,r),this._readRequests=new N}get closed(){return $e(this)?this._closedPromise:S(Or("closed"))}cancel(r=void 0){return $e(this)?this._ownerReadableStream===void 0?S(C("cancel")):g(this,r):S(Or("cancel"))}read(){if(!$e(this))return S(Or("read"));if(this._ownerReadableStream===void 0)return S(C("read from"));let r,s,u=h((d,m)=>{r=d,s=m});return er(this,{_chunkSteps:d=>r({value:d,done:!1}),_closeSteps:()=>r({value:void 0,done:!0}),_errorSteps:d=>s(d)}),u}releaseLock(){if(!$e(this))throw Or("releaseLock");this._ownerReadableStream!==void 0&&lu(this)}}Object.defineProperties(je.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),l(je.prototype.cancel,"cancel"),l(je.prototype.read,"read"),l(je.prototype.releaseLock,"releaseLock"),typeof t.toStringTag=="symbol"&&Object.defineProperty(je.prototype,t.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});function $e(e){return!i(e)||!Object.prototype.hasOwnProperty.call(e,"_readRequests")?!1:e instanceof je}function er(e,r){let s=e._ownerReadableStream;s._disturbed=!0,s._state==="closed"?r._closeSteps():s._state==="errored"?r._errorSteps(s._storedError):s._readableStreamController[It](r)}function lu(e){E(e);let r=new TypeError("Reader was released");ai(e,r)}function ai(e,r){let s=e._readRequests;e._readRequests=new N,s.forEach(u=>{u._errorSteps(r)})}function Or(e){return new TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}let li=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype);class ui{constructor(r,s){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=r,this._preventCancel=s}next(){let r=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?L(this._ongoingPromise,r,r):r(),this._ongoingPromise}return(r){let s=()=>this._returnSteps(r);return this._ongoingPromise?L(this._ongoingPromise,s,s):s()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let r=this._reader,s,u,f=h((m,T)=>{s=m,u=T});return er(r,{_chunkSteps:m=>{this._ongoingPromise=void 0,z(()=>s({value:m,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,E(r),s({value:void 0,done:!0})},_errorSteps:m=>{this._ongoingPromise=void 0,this._isFinished=!0,E(r),u(m)}}),f}_returnSteps(r){if(this._isFinished)return Promise.resolve({value:r,done:!0});this._isFinished=!0;let s=this._reader;if(!this._preventCancel){let u=g(s,r);return E(s),L(u,()=>({value:r,done:!0}))}return E(s),b({value:r,done:!0})}}let ci={next(){return fi(this)?this._asyncIteratorImpl.next():S(di("next"))},return(e){return fi(this)?this._asyncIteratorImpl.return(e):S(di("return"))}};li!==void 0&&Object.setPrototypeOf(ci,li);function uu(e,r){let s=At(e),u=new ui(s,r),f=Object.create(ci);return f._asyncIteratorImpl=u,f}function fi(e){if(!i(e)||!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl"))return!1;try{return e._asyncIteratorImpl instanceof ui}catch{return!1}}function di(e){return new TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}let hi=Number.isNaN||function(e){return e!==e};function tr(e){return e.slice()}function mi(e,r,s,u,f){new Uint8Array(e).set(new Uint8Array(s,u,f),r)}let ke=e=>(typeof e.transfer=="function"?ke=r=>r.transfer():typeof structuredClone=="function"?ke=r=>structuredClone(r,{transfer:[r]}):ke=r=>r,ke(e)),He=e=>(typeof e.detached=="boolean"?He=r=>r.detached:He=r=>r.byteLength===0,He(e));function pi(e,r,s){if(e.slice)return e.slice(r,s);let u=s-r,f=new ArrayBuffer(u);return mi(f,0,e,r,u),f}function Dr(e,r){let s=e[r];if(s!=null){if(typeof s!="function")throw new TypeError(`${String(r)} is not a function`);return s}}function cu(e){let r={[t.iterator]:()=>e.iterator},s=async function*(){return yield*r}(),u=s.next;return{iterator:s,nextMethod:u,done:!1}}function yi(e,r="sync",s){if(s===void 0)if(r==="async"){if(s=Dr(e,t.asyncIterator),s===void 0){let d=Dr(e,t.iterator),m=yi(e,"sync",d);return cu(m)}}else s=Dr(e,t.iterator);if(s===void 0)throw new TypeError("The object is not iterable");let u=X(s,e,[]);if(!i(u))throw new TypeError("The iterator method must return an object");let f=u.next;return{iterator:u,nextMethod:f,done:!1}}function fu(e){let r=X(e.nextMethod,e.iterator,[]);if(!i(r))throw new TypeError("The iterator.next() method must return an object");return r}function du(e){return!!e.done}function hu(e){return e.value}function mu(e){return!(typeof e!="number"||hi(e)||e<0)}function bi(e){let r=pi(e.buffer,e.byteOffset,e.byteOffset+e.byteLength);return new Uint8Array(r)}function jn(e){let r=e._queue.shift();return e._queueTotalSize-=r.size,e._queueTotalSize<0&&(e._queueTotalSize=0),r.value}function $n(e,r,s){if(!mu(s)||s===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:r,size:s}),e._queueTotalSize+=s}function pu(e){return e._queue.peek().value}function Ve(e){e._queue=new N,e._queueTotalSize=0}function gi(e){return e===DataView}function yu(e){return gi(e.constructor)}function bu(e){return gi(e)?1:e.BYTES_PER_ELEMENT}class ct{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!Hn(this))throw Qn("view");return this._view}respond(r){if(!Hn(this))throw Qn("respond");if(De(r,1,"respond"),r=Wn(r,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");if(He(this._view.buffer))throw new TypeError("The BYOB request's buffer has been detached and so cannot be used as a response");Br(this._associatedReadableByteStreamController,r)}respondWithNewView(r){if(!Hn(this))throw Qn("respondWithNewView");if(De(r,1,"respondWithNewView"),!ArrayBuffer.isView(r))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");if(He(r.buffer))throw new TypeError("The given view's buffer has been detached and so cannot be used as a response");Mr(this._associatedReadableByteStreamController,r)}}Object.defineProperties(ct.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),l(ct.prototype.respond,"respond"),l(ct.prototype.respondWithNewView,"respondWithNewView"),typeof t.toStringTag=="symbol"&&Object.defineProperty(ct.prototype,t.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class Ne{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!ft(this))throw nr("byobRequest");return Kn(this)}get desiredSize(){if(!ft(this))throw nr("desiredSize");return Ai(this)}close(){if(!ft(this))throw nr("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");let r=this._controlledReadableByteStream._state;if(r!=="readable")throw new TypeError(`The stream (in ${r} state) is not in the readable state and cannot be closed`);rr(this)}enqueue(r){if(!ft(this))throw nr("enqueue");if(De(r,1,"enqueue"),!ArrayBuffer.isView(r))throw new TypeError("chunk must be an array buffer view");if(r.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(r.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");let s=this._controlledReadableByteStream._state;if(s!=="readable")throw new TypeError(`The stream (in ${s} state) is not in the readable state and cannot be enqueued to`);Fr(this,r)}error(r=void 0){if(!ft(this))throw nr("error");ye(this,r)}[at](r){Si(this),Ve(this);let s=this._cancelAlgorithm(r);return Nr(this),s}[It](r){let s=this._controlledReadableByteStream;if(this._queueTotalSize>0){Ii(this,r);return}let u=this._autoAllocateChunkSize;if(u!==void 0){let f;try{f=new ArrayBuffer(u)}catch(m){r._errorSteps(m);return}let d={buffer:f,bufferByteLength:u,byteOffset:0,byteLength:u,bytesFilled:0,minimumFill:1,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(d)}ii(s,r),dt(this)}[lt](){if(this._pendingPullIntos.length>0){let r=this._pendingPullIntos.peek();r.readerType="none",this._pendingPullIntos=new N,this._pendingPullIntos.push(r)}}}Object.defineProperties(Ne.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),l(Ne.prototype.close,"close"),l(Ne.prototype.enqueue,"enqueue"),l(Ne.prototype.error,"error"),typeof t.toStringTag=="symbol"&&Object.defineProperty(Ne.prototype,t.toStringTag,{value:"ReadableByteStreamController",configurable:!0});function ft(e){return!i(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")?!1:e instanceof Ne}function Hn(e){return!i(e)||!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")?!1:e instanceof ct}function dt(e){if(!Eu(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let s=e._pullAlgorithm();A(s,()=>(e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,dt(e)),null),u=>(ye(e,u),null))}function Si(e){Gn(e),e._pendingPullIntos=new N}function Vn(e,r){let s=!1;e._state==="closed"&&(s=!0);let u=wi(r);r.readerType==="default"?qn(e,u,s):Au(e,u,s)}function wi(e){let r=e.bytesFilled,s=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,r/s)}function kr(e,r,s,u){e._queue.push({buffer:r,byteOffset:s,byteLength:u}),e._queueTotalSize+=u}function _i(e,r,s,u){let f;try{f=pi(r,s,s+u)}catch(d){throw ye(e,d),d}kr(e,f,0,u)}function Ei(e,r){r.bytesFilled>0&&_i(e,r.buffer,r.byteOffset,r.bytesFilled),vt(e)}function Ti(e,r){let s=Math.min(e._queueTotalSize,r.byteLength-r.bytesFilled),u=r.bytesFilled+s,f=s,d=!1,m=u%r.elementSize,T=u-m;T>=r.minimumFill&&(f=T-r.bytesFilled,d=!0);let x=e._queue;for(;f>0;){let P=x.peek(),O=Math.min(f,P.byteLength),F=r.byteOffset+r.bytesFilled;mi(r.buffer,F,P.buffer,P.byteOffset,O),P.byteLength===O?x.shift():(P.byteOffset+=O,P.byteLength-=O),e._queueTotalSize-=O,Ri(e,O,r),f-=O}return d}function Ri(e,r,s){s.bytesFilled+=r}function Ci(e){e._queueTotalSize===0&&e._closeRequested?(Nr(e),ur(e._controlledReadableByteStream)):dt(e)}function Gn(e){e._byobRequest!==null&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function Yn(e){for(;e._pendingPullIntos.length>0;){if(e._queueTotalSize===0)return;let r=e._pendingPullIntos.peek();Ti(e,r)&&(vt(e),Vn(e._controlledReadableByteStream,r))}}function gu(e){let r=e._controlledReadableByteStream._reader;for(;r._readRequests.length>0;){if(e._queueTotalSize===0)return;let s=r._readRequests.shift();Ii(e,s)}}function Su(e,r,s,u){let f=e._controlledReadableByteStream,d=r.constructor,m=bu(d),{byteOffset:T,byteLength:x}=r,P=s*m,O;try{O=ke(r.buffer)}catch(q){u._errorSteps(q);return}let F={buffer:O,bufferByteLength:O.byteLength,byteOffset:T,byteLength:x,bytesFilled:0,minimumFill:P,elementSize:m,viewConstructor:d,readerType:"byob"};if(e._pendingPullIntos.length>0){e._pendingPullIntos.push(F),Li(f,u);return}if(f._state==="closed"){let q=new d(F.buffer,F.byteOffset,0);u._closeSteps(q);return}if(e._queueTotalSize>0){if(Ti(e,F)){let q=wi(F);Ci(e),u._chunkSteps(q);return}if(e._closeRequested){let q=new TypeError("Insufficient bytes to fill elements in the given buffer");ye(e,q),u._errorSteps(q);return}}e._pendingPullIntos.push(F),Li(f,u),dt(e)}function wu(e,r){r.readerType==="none"&&vt(e);let s=e._controlledReadableByteStream;if(Zn(s))for(;Oi(s)>0;){let u=vt(e);Vn(s,u)}}function _u(e,r,s){if(Ri(e,r,s),s.readerType==="none"){Ei(e,s),Yn(e);return}if(s.bytesFilled<s.minimumFill)return;vt(e);let u=s.bytesFilled%s.elementSize;if(u>0){let f=s.byteOffset+s.bytesFilled;_i(e,s.buffer,f-u,u)}s.bytesFilled-=u,Vn(e._controlledReadableByteStream,s),Yn(e)}function Pi(e,r){let s=e._pendingPullIntos.peek();Gn(e),e._controlledReadableByteStream._state==="closed"?wu(e,s):_u(e,r,s),dt(e)}function vt(e){return e._pendingPullIntos.shift()}function Eu(e){let r=e._controlledReadableByteStream;return r._state!=="readable"||e._closeRequested||!e._started?!1:!!(si(r)&&Lr(r)>0||Zn(r)&&Oi(r)>0||Ai(e)>0)}function Nr(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function rr(e){let r=e._controlledReadableByteStream;if(!(e._closeRequested||r._state!=="readable")){if(e._queueTotalSize>0){e._closeRequested=!0;return}if(e._pendingPullIntos.length>0){let s=e._pendingPullIntos.peek();if(s.bytesFilled%s.elementSize!==0){let u=new TypeError("Insufficient bytes to fill elements in the given buffer");throw ye(e,u),u}}Nr(e),ur(r)}}function Fr(e,r){let s=e._controlledReadableByteStream;if(e._closeRequested||s._state!=="readable")return;let{buffer:u,byteOffset:f,byteLength:d}=r;if(He(u))throw new TypeError("chunk's buffer is detached and so cannot be enqueued");let m=ke(u);if(e._pendingPullIntos.length>0){let T=e._pendingPullIntos.peek();if(He(T.buffer))throw new TypeError("The BYOB request's buffer has been detached and so cannot be filled with an enqueued chunk");Gn(e),T.buffer=ke(T.buffer),T.readerType==="none"&&Ei(e,T)}if(si(s))if(gu(e),Lr(s)===0)kr(e,m,f,d);else{e._pendingPullIntos.length>0&&vt(e);let T=new Uint8Array(m,f,d);qn(s,T,!1)}else Zn(s)?(kr(e,m,f,d),Yn(e)):kr(e,m,f,d);dt(e)}function ye(e,r){let s=e._controlledReadableByteStream;s._state==="readable"&&(Si(e),Ve(e),Nr(e),rs(s,r))}function Ii(e,r){let s=e._queue.shift();e._queueTotalSize-=s.byteLength,Ci(e);let u=new Uint8Array(s.buffer,s.byteOffset,s.byteLength);r._chunkSteps(u)}function Kn(e){if(e._byobRequest===null&&e._pendingPullIntos.length>0){let r=e._pendingPullIntos.peek(),s=new Uint8Array(r.buffer,r.byteOffset+r.bytesFilled,r.byteLength-r.bytesFilled),u=Object.create(ct.prototype);Ru(u,e,s),e._byobRequest=u}return e._byobRequest}function Ai(e){let r=e._controlledReadableByteStream._state;return r==="errored"?null:r==="closed"?0:e._strategyHWM-e._queueTotalSize}function Br(e,r){let s=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(r!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(r===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(s.bytesFilled+r>s.byteLength)throw new RangeError("bytesWritten out of range")}s.buffer=ke(s.buffer),Pi(e,r)}function Mr(e,r){let s=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(r.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(r.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(s.byteOffset+s.bytesFilled!==r.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(s.bufferByteLength!==r.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(s.bytesFilled+r.byteLength>s.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");let f=r.byteLength;s.buffer=ke(r.buffer),Pi(e,f)}function vi(e,r,s,u,f,d,m){r._controlledReadableByteStream=e,r._pullAgain=!1,r._pulling=!1,r._byobRequest=null,r._queue=r._queueTotalSize=void 0,Ve(r),r._closeRequested=!1,r._started=!1,r._strategyHWM=d,r._pullAlgorithm=u,r._cancelAlgorithm=f,r._autoAllocateChunkSize=m,r._pendingPullIntos=new N,e._readableStreamController=r;let T=s();A(b(T),()=>(r._started=!0,dt(r),null),x=>(ye(r,x),null))}function Tu(e,r,s){let u=Object.create(Ne.prototype),f,d,m;r.start!==void 0?f=()=>r.start(u):f=()=>{},r.pull!==void 0?d=()=>r.pull(u):d=()=>b(void 0),r.cancel!==void 0?m=x=>r.cancel(x):m=()=>b(void 0);let T=r.autoAllocateChunkSize;if(T===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");vi(e,u,f,d,m,s,T)}function Ru(e,r,s){e._associatedReadableByteStreamController=r,e._view=s}function Qn(e){return new TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function nr(e){return new TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function Cu(e,r){Ie(e,r);let s=e?.mode;return{mode:s===void 0?void 0:Pu(s,`${r} has member 'mode' that`)}}function Pu(e,r){if(e=`${e}`,e!=="byob")throw new TypeError(`${r} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}function Iu(e,r){var s;Ie(e,r);let u=(s=e?.min)!==null&&s!==void 0?s:1;return{min:Wn(u,`${r} has member 'min' that`)}}function xi(e){return new Ge(e)}function Li(e,r){e._reader._readIntoRequests.push(r)}function Au(e,r,s){let f=e._reader._readIntoRequests.shift();s?f._closeSteps(r):f._chunkSteps(r)}function Oi(e){return e._reader._readIntoRequests.length}function Zn(e){let r=e._reader;return!(r===void 0||!ht(r))}class Ge{constructor(r){if(De(r,1,"ReadableStreamBYOBReader"),zn(r,"First parameter"),Qe(r))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!ft(r._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");xr(this,r),this._readIntoRequests=new N}get closed(){return ht(this)?this._closedPromise:S(Ur("closed"))}cancel(r=void 0){return ht(this)?this._ownerReadableStream===void 0?S(C("cancel")):g(this,r):S(Ur("cancel"))}read(r,s={}){if(!ht(this))return S(Ur("read"));if(!ArrayBuffer.isView(r))return S(new TypeError("view must be an array buffer view"));if(r.byteLength===0)return S(new TypeError("view must have non-zero byteLength"));if(r.buffer.byteLength===0)return S(new TypeError("view's buffer must have non-zero byteLength"));if(He(r.buffer))return S(new TypeError("view's buffer has been detached"));let u;try{u=Iu(s,"options")}catch(P){return S(P)}let f=u.min;if(f===0)return S(new TypeError("options.min must be greater than 0"));if(yu(r)){if(f>r.byteLength)return S(new RangeError("options.min must be less than or equal to view's byteLength"))}else if(f>r.length)return S(new RangeError("options.min must be less than or equal to view's length"));if(this._ownerReadableStream===void 0)return S(C("read from"));let d,m,T=h((P,O)=>{d=P,m=O});return Di(this,r,f,{_chunkSteps:P=>d({value:P,done:!1}),_closeSteps:P=>d({value:P,done:!0}),_errorSteps:P=>m(P)}),T}releaseLock(){if(!ht(this))throw Ur("releaseLock");this._ownerReadableStream!==void 0&&vu(this)}}Object.defineProperties(Ge.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),l(Ge.prototype.cancel,"cancel"),l(Ge.prototype.read,"read"),l(Ge.prototype.releaseLock,"releaseLock"),typeof t.toStringTag=="symbol"&&Object.defineProperty(Ge.prototype,t.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});function ht(e){return!i(e)||!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")?!1:e instanceof Ge}function Di(e,r,s,u){let f=e._ownerReadableStream;f._disturbed=!0,f._state==="errored"?u._errorSteps(f._storedError):Su(f._readableStreamController,r,s,u)}function vu(e){E(e);let r=new TypeError("Reader was released");ki(e,r)}function ki(e,r){let s=e._readIntoRequests;e._readIntoRequests=new N,s.forEach(u=>{u._errorSteps(r)})}function Ur(e){return new TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function or(e,r){let{highWaterMark:s}=e;if(s===void 0)return r;if(hi(s)||s<0)throw new RangeError("Invalid highWaterMark");return s}function Wr(e){let{size:r}=e;return r||(()=>1)}function zr(e,r){Ie(e,r);let s=e?.highWaterMark,u=e?.size;return{highWaterMark:s===void 0?void 0:Un(s),size:u===void 0?void 0:xu(u,`${r} has member 'size' that`)}}function xu(e,r){return pe(e,r),s=>Un(e(s))}function Lu(e,r){Ie(e,r);let s=e?.abort,u=e?.close,f=e?.start,d=e?.type,m=e?.write;return{abort:s===void 0?void 0:Ou(s,e,`${r} has member 'abort' that`),close:u===void 0?void 0:Du(u,e,`${r} has member 'close' that`),start:f===void 0?void 0:ku(f,e,`${r} has member 'start' that`),write:m===void 0?void 0:Nu(m,e,`${r} has member 'write' that`),type:d}}function Ou(e,r,s){return pe(e,s),u=>D(e,r,[u])}function Du(e,r,s){return pe(e,s),()=>D(e,r,[])}function ku(e,r,s){return pe(e,s),u=>X(e,r,[u])}function Nu(e,r,s){return pe(e,s),(u,f)=>D(e,r,[u,f])}function Ni(e,r){if(!xt(e))throw new TypeError(`${r} is not a WritableStream.`)}function Fu(e){if(typeof e!="object"||e===null)return!1;try{return typeof e.aborted=="boolean"}catch{return!1}}let Bu=typeof AbortController=="function";function Mu(){if(Bu)return new AbortController}class Ye{constructor(r={},s={}){r===void 0?r=null:ni(r,"First parameter");let u=zr(s,"Second parameter"),f=Lu(r,"First parameter");if(Bi(this),f.type!==void 0)throw new RangeError("Invalid type is specified");let m=Wr(u),T=or(u,1);Xu(this,f,T,m)}get locked(){if(!xt(this))throw Vr("locked");return Lt(this)}abort(r=void 0){return xt(this)?Lt(this)?S(new TypeError("Cannot abort a stream that already has a writer")):qr(this,r):S(Vr("abort"))}close(){return xt(this)?Lt(this)?S(new TypeError("Cannot close a stream that already has a writer")):Ae(this)?S(new TypeError("Cannot close an already-closing stream")):Mi(this):S(Vr("close"))}getWriter(){if(!xt(this))throw Vr("getWriter");return Fi(this)}}Object.defineProperties(Ye.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),l(Ye.prototype.abort,"abort"),l(Ye.prototype.close,"close"),l(Ye.prototype.getWriter,"getWriter"),typeof t.toStringTag=="symbol"&&Object.defineProperty(Ye.prototype,t.toStringTag,{value:"WritableStream",configurable:!0});function Fi(e){return new Fe(e)}function Uu(e,r,s,u,f=1,d=()=>1){let m=Object.create(Ye.prototype);Bi(m);let T=Object.create(Ot.prototype);return $i(m,T,e,r,s,u,f,d),m}function Bi(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new N,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function xt(e){return!i(e)||!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")?!1:e instanceof Ye}function Lt(e){return e._writer!==void 0}function qr(e,r){var s;if(e._state==="closed"||e._state==="errored")return b(void 0);e._writableStreamController._abortReason=r,(s=e._writableStreamController._abortController)===null||s===void 0||s.abort(r);let u=e._state;if(u==="closed"||u==="errored")return b(void 0);if(e._pendingAbortRequest!==void 0)return e._pendingAbortRequest._promise;let f=!1;u==="erroring"&&(f=!0,r=void 0);let d=h((m,T)=>{e._pendingAbortRequest={_promise:void 0,_resolve:m,_reject:T,_reason:r,_wasAlreadyErroring:f}});return e._pendingAbortRequest._promise=d,f||Jn(e,r),d}function Mi(e){let r=e._state;if(r==="closed"||r==="errored")return S(new TypeError(`The stream (in ${r} state) is not in the writable state and cannot be closed`));let s=h((f,d)=>{let m={_resolve:f,_reject:d};e._closeRequest=m}),u=e._writer;return u!==void 0&&e._backpressure&&r==="writable"&&ao(u),Ju(e._writableStreamController),s}function Wu(e){return h((s,u)=>{let f={_resolve:s,_reject:u};e._writeRequests.push(f)})}function Xn(e,r){if(e._state==="writable"){Jn(e,r);return}eo(e)}function Jn(e,r){let s=e._writableStreamController;e._state="erroring",e._storedError=r;let u=e._writer;u!==void 0&&Wi(u,r),!Hu(e)&&s._started&&eo(e)}function eo(e){e._state="errored",e._writableStreamController[st]();let r=e._storedError;if(e._writeRequests.forEach(f=>{f._reject(r)}),e._writeRequests=new N,e._pendingAbortRequest===void 0){jr(e);return}let s=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,s._wasAlreadyErroring){s._reject(r),jr(e);return}let u=e._writableStreamController[ie](s._reason);A(u,()=>(s._resolve(),jr(e),null),f=>(s._reject(f),jr(e),null))}function zu(e){e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}function qu(e,r){e._inFlightWriteRequest._reject(r),e._inFlightWriteRequest=void 0,Xn(e,r)}function ju(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0,e._state==="erroring"&&(e._storedError=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";let s=e._writer;s!==void 0&&Yi(s)}function $u(e,r){e._inFlightCloseRequest._reject(r),e._inFlightCloseRequest=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._reject(r),e._pendingAbortRequest=void 0),Xn(e,r)}function Ae(e){return!(e._closeRequest===void 0&&e._inFlightCloseRequest===void 0)}function Hu(e){return!(e._inFlightWriteRequest===void 0&&e._inFlightCloseRequest===void 0)}function Vu(e){e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0}function Gu(e){e._inFlightWriteRequest=e._writeRequests.shift()}function jr(e){e._closeRequest!==void 0&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);let r=e._writer;r!==void 0&&io(r,e._storedError)}function to(e,r){let s=e._writer;s!==void 0&&r!==e._backpressure&&(r?sc(s):ao(s)),e._backpressure=r}class Fe{constructor(r){if(De(r,1,"WritableStreamDefaultWriter"),Ni(r,"First parameter"),Lt(r))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=r,r._writer=this;let s=r._state;if(s==="writable")!Ae(r)&&r._backpressure?Yr(this):Ki(this),Gr(this);else if(s==="erroring")so(this,r._storedError),Gr(this);else if(s==="closed")Ki(this),oc(this);else{let u=r._storedError;so(this,u),Gi(this,u)}}get closed(){return mt(this)?this._closedPromise:S(pt("closed"))}get desiredSize(){if(!mt(this))throw pt("desiredSize");if(this._ownerWritableStream===void 0)throw sr("desiredSize");return Zu(this)}get ready(){return mt(this)?this._readyPromise:S(pt("ready"))}abort(r=void 0){return mt(this)?this._ownerWritableStream===void 0?S(sr("abort")):Yu(this,r):S(pt("abort"))}close(){if(!mt(this))return S(pt("close"));let r=this._ownerWritableStream;return r===void 0?S(sr("close")):Ae(r)?S(new TypeError("Cannot close an already-closing stream")):Ui(this)}releaseLock(){if(!mt(this))throw pt("releaseLock");this._ownerWritableStream!==void 0&&zi(this)}write(r=void 0){return mt(this)?this._ownerWritableStream===void 0?S(sr("write to")):qi(this,r):S(pt("write"))}}Object.defineProperties(Fe.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),l(Fe.prototype.abort,"abort"),l(Fe.prototype.close,"close"),l(Fe.prototype.releaseLock,"releaseLock"),l(Fe.prototype.write,"write"),typeof t.toStringTag=="symbol"&&Object.defineProperty(Fe.prototype,t.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});function mt(e){return!i(e)||!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")?!1:e instanceof Fe}function Yu(e,r){let s=e._ownerWritableStream;return qr(s,r)}function Ui(e){let r=e._ownerWritableStream;return Mi(r)}function Ku(e){let r=e._ownerWritableStream,s=r._state;return Ae(r)||s==="closed"?b(void 0):s==="errored"?S(r._storedError):Ui(e)}function Qu(e,r){e._closedPromiseState==="pending"?io(e,r):ic(e,r)}function Wi(e,r){e._readyPromiseState==="pending"?Qi(e,r):ac(e,r)}function Zu(e){let r=e._ownerWritableStream,s=r._state;return s==="errored"||s==="erroring"?null:s==="closed"?0:Hi(r._writableStreamController)}function zi(e){let r=e._ownerWritableStream,s=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");Wi(e,s),Qu(e,s),r._writer=void 0,e._ownerWritableStream=void 0}function qi(e,r){let s=e._ownerWritableStream,u=s._writableStreamController,f=ec(u,r);if(s!==e._ownerWritableStream)return S(sr("write to"));let d=s._state;if(d==="errored")return S(s._storedError);if(Ae(s)||d==="closed")return S(new TypeError("The stream is closing or closed and cannot be written to"));if(d==="erroring")return S(s._storedError);let m=Wu(s);return tc(u,r,f),m}let ji={};class Ot{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!ro(this))throw oo("abortReason");return this._abortReason}get signal(){if(!ro(this))throw oo("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(r=void 0){if(!ro(this))throw oo("error");this._controlledWritableStream._state==="writable"&&Vi(this,r)}[ie](r){let s=this._abortAlgorithm(r);return $r(this),s}[st](){Ve(this)}}Object.defineProperties(Ot.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Ot.prototype,t.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});function ro(e){return!i(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")?!1:e instanceof Ot}function $i(e,r,s,u,f,d,m,T){r._controlledWritableStream=e,e._writableStreamController=r,r._queue=void 0,r._queueTotalSize=void 0,Ve(r),r._abortReason=void 0,r._abortController=Mu(),r._started=!1,r._strategySizeAlgorithm=T,r._strategyHWM=m,r._writeAlgorithm=u,r._closeAlgorithm=f,r._abortAlgorithm=d;let x=no(r);to(e,x);let P=s(),O=b(P);A(O,()=>(r._started=!0,Hr(r),null),F=>(r._started=!0,Xn(e,F),null))}function Xu(e,r,s,u){let f=Object.create(Ot.prototype),d,m,T,x;r.start!==void 0?d=()=>r.start(f):d=()=>{},r.write!==void 0?m=P=>r.write(P,f):m=()=>b(void 0),r.close!==void 0?T=()=>r.close():T=()=>b(void 0),r.abort!==void 0?x=P=>r.abort(P):x=()=>b(void 0),$i(e,f,d,m,T,x,s,u)}function $r(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Ju(e){$n(e,ji,0),Hr(e)}function ec(e,r){try{return e._strategySizeAlgorithm(r)}catch(s){return ir(e,s),1}}function Hi(e){return e._strategyHWM-e._queueTotalSize}function tc(e,r,s){try{$n(e,r,s)}catch(f){ir(e,f);return}let u=e._controlledWritableStream;if(!Ae(u)&&u._state==="writable"){let f=no(e);to(u,f)}Hr(e)}function Hr(e){let r=e._controlledWritableStream;if(!e._started||r._inFlightWriteRequest!==void 0)return;if(r._state==="erroring"){eo(r);return}if(e._queue.length===0)return;let u=pu(e);u===ji?rc(e):nc(e,u)}function ir(e,r){e._controlledWritableStream._state==="writable"&&Vi(e,r)}function rc(e){let r=e._controlledWritableStream;Vu(r),jn(e);let s=e._closeAlgorithm();$r(e),A(s,()=>(ju(r),null),u=>($u(r,u),null))}function nc(e,r){let s=e._controlledWritableStream;Gu(s);let u=e._writeAlgorithm(r);A(u,()=>{zu(s);let f=s._state;if(jn(e),!Ae(s)&&f==="writable"){let d=no(e);to(s,d)}return Hr(e),null},f=>(s._state==="writable"&&$r(e),qu(s,f),null))}function no(e){return Hi(e)<=0}function Vi(e,r){let s=e._controlledWritableStream;$r(e),Jn(s,r)}function Vr(e){return new TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function oo(e){return new TypeError(`WritableStreamDefaultController.prototype.${e} can only be used on a WritableStreamDefaultController`)}function pt(e){return new TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function sr(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function Gr(e){e._closedPromise=h((r,s)=>{e._closedPromise_resolve=r,e._closedPromise_reject=s,e._closedPromiseState="pending"})}function Gi(e,r){Gr(e),io(e,r)}function oc(e){Gr(e),Yi(e)}function io(e,r){e._closedPromise_reject!==void 0&&(k(e._closedPromise),e._closedPromise_reject(r),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function ic(e,r){Gi(e,r)}function Yi(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function Yr(e){e._readyPromise=h((r,s)=>{e._readyPromise_resolve=r,e._readyPromise_reject=s}),e._readyPromiseState="pending"}function so(e,r){Yr(e),Qi(e,r)}function Ki(e){Yr(e),ao(e)}function Qi(e,r){e._readyPromise_reject!==void 0&&(k(e._readyPromise),e._readyPromise_reject(r),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function sc(e){Yr(e)}function ac(e,r){so(e,r)}function ao(e){e._readyPromise_resolve!==void 0&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}function lc(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof global<"u")return global}let lo=lc();function uc(e){if(!(typeof e=="function"||typeof e=="object")||e.name!=="DOMException")return!1;try{return new e,!0}catch{return!1}}function cc(){let e=lo?.DOMException;return uc(e)?e:void 0}function fc(){let e=function(s,u){this.message=s||"",this.name=u||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return l(e,"DOMException"),e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}let dc=cc()||fc();function Zi(e,r,s,u,f,d){let m=At(e),T=Fi(r);e._disturbed=!0;let x=!1,P=b(void 0);return h((O,F)=>{let q;if(d!==void 0){if(q=()=>{let I=d.reason!==void 0?d.reason:new dc("Aborted","AbortError"),M=[];u||M.push(()=>r._state==="writable"?qr(r,I):b(void 0)),f||M.push(()=>e._state==="readable"?Te(e,I):b(void 0)),ae(()=>Promise.all(M.map($=>$())),!0,I)},d.aborted){q();return}d.addEventListener("abort",q)}function Re(){return h((I,M)=>{function $(fe){fe?I():v(Ft(),$,M)}$(!1)})}function Ft(){return x?b(!0):v(T._readyPromise,()=>h((I,M)=>{er(m,{_chunkSteps:$=>{P=v(qi(T,$),void 0,n),I(!1)},_closeSteps:()=>I(!0),_errorSteps:M})}))}if(Me(e,m._closedPromise,I=>(u?be(!0,I):ae(()=>qr(r,I),!0,I),null)),Me(r,T._closedPromise,I=>(f?be(!0,I):ae(()=>Te(e,I),!0,I),null)),oe(e,m._closedPromise,()=>(s?be():ae(()=>Ku(T)),null)),Ae(r)||r._state==="closed"){let I=new TypeError("the destination writable stream closed before all data could be piped to it");f?be(!0,I):ae(()=>Te(e,I),!0,I)}k(Re());function Xe(){let I=P;return v(P,()=>I!==P?Xe():void 0)}function Me(I,M,$){I._state==="errored"?$(I._storedError):W(M,$)}function oe(I,M,$){I._state==="closed"?$():w(M,$)}function ae(I,M,$){if(x)return;x=!0,r._state==="writable"&&!Ae(r)?w(Xe(),fe):fe();function fe(){return A(I(),()=>Ue(M,$),Bt=>Ue(!0,Bt)),null}}function be(I,M){x||(x=!0,r._state==="writable"&&!Ae(r)?w(Xe(),()=>Ue(I,M)):Ue(I,M))}function Ue(I,M){return zi(T),E(m),d!==void 0&&d.removeEventListener("abort",q),I?F(M):O(void 0),null}})}class Be{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Kr(this))throw Zr("desiredSize");return uo(this)}close(){if(!Kr(this))throw Zr("close");if(!kt(this))throw new TypeError("The stream is not in a state that permits close");yt(this)}enqueue(r=void 0){if(!Kr(this))throw Zr("enqueue");if(!kt(this))throw new TypeError("The stream is not in a state that permits enqueue");return Dt(this,r)}error(r=void 0){if(!Kr(this))throw Zr("error");Ee(this,r)}[at](r){Ve(this);let s=this._cancelAlgorithm(r);return Qr(this),s}[It](r){let s=this._controlledReadableStream;if(this._queue.length>0){let u=jn(this);this._closeRequested&&this._queue.length===0?(Qr(this),ur(s)):ar(this),r._chunkSteps(u)}else ii(s,r),ar(this)}[lt](){}}Object.defineProperties(Be.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),l(Be.prototype.close,"close"),l(Be.prototype.enqueue,"enqueue"),l(Be.prototype.error,"error"),typeof t.toStringTag=="symbol"&&Object.defineProperty(Be.prototype,t.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});function Kr(e){return!i(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")?!1:e instanceof Be}function ar(e){if(!Xi(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let s=e._pullAlgorithm();A(s,()=>(e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,ar(e)),null),u=>(Ee(e,u),null))}function Xi(e){let r=e._controlledReadableStream;return!kt(e)||!e._started?!1:!!(Qe(r)&&Lr(r)>0||uo(e)>0)}function Qr(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function yt(e){if(!kt(e))return;let r=e._controlledReadableStream;e._closeRequested=!0,e._queue.length===0&&(Qr(e),ur(r))}function Dt(e,r){if(!kt(e))return;let s=e._controlledReadableStream;if(Qe(s)&&Lr(s)>0)qn(s,r,!1);else{let u;try{u=e._strategySizeAlgorithm(r)}catch(f){throw Ee(e,f),f}try{$n(e,r,u)}catch(f){throw Ee(e,f),f}}ar(e)}function Ee(e,r){let s=e._controlledReadableStream;s._state==="readable"&&(Ve(e),Qr(e),rs(s,r))}function uo(e){let r=e._controlledReadableStream._state;return r==="errored"?null:r==="closed"?0:e._strategyHWM-e._queueTotalSize}function hc(e){return!Xi(e)}function kt(e){let r=e._controlledReadableStream._state;return!e._closeRequested&&r==="readable"}function Ji(e,r,s,u,f,d,m){r._controlledReadableStream=e,r._queue=void 0,r._queueTotalSize=void 0,Ve(r),r._started=!1,r._closeRequested=!1,r._pullAgain=!1,r._pulling=!1,r._strategySizeAlgorithm=m,r._strategyHWM=d,r._pullAlgorithm=u,r._cancelAlgorithm=f,e._readableStreamController=r;let T=s();A(b(T),()=>(r._started=!0,ar(r),null),x=>(Ee(r,x),null))}function mc(e,r,s,u){let f=Object.create(Be.prototype),d,m,T;r.start!==void 0?d=()=>r.start(f):d=()=>{},r.pull!==void 0?m=()=>r.pull(f):m=()=>b(void 0),r.cancel!==void 0?T=x=>r.cancel(x):T=()=>b(void 0),Ji(e,f,d,m,T,s,u)}function Zr(e){return new TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function pc(e,r){return ft(e._readableStreamController)?bc(e):yc(e)}function yc(e,r){let s=At(e),u=!1,f=!1,d=!1,m=!1,T,x,P,O,F,q=h(oe=>{F=oe});function Re(){return u?(f=!0,b(void 0)):(u=!0,er(s,{_chunkSteps:ae=>{z(()=>{f=!1;let be=ae,Ue=ae;d||Dt(P._readableStreamController,be),m||Dt(O._readableStreamController,Ue),u=!1,f&&Re()})},_closeSteps:()=>{u=!1,d||yt(P._readableStreamController),m||yt(O._readableStreamController),(!d||!m)&&F(void 0)},_errorSteps:()=>{u=!1}}),b(void 0))}function Ft(oe){if(d=!0,T=oe,m){let ae=tr([T,x]),be=Te(e,ae);F(be)}return q}function Xe(oe){if(m=!0,x=oe,d){let ae=tr([T,x]),be=Te(e,ae);F(be)}return q}function Me(){}return P=lr(Me,Re,Ft),O=lr(Me,Re,Xe),W(s._closedPromise,oe=>(Ee(P._readableStreamController,oe),Ee(O._readableStreamController,oe),(!d||!m)&&F(void 0),null)),[P,O]}function bc(e){let r=At(e),s=!1,u=!1,f=!1,d=!1,m=!1,T,x,P,O,F,q=h(I=>{F=I});function Re(I){W(I._closedPromise,M=>(I!==r||(ye(P._readableStreamController,M),ye(O._readableStreamController,M),(!d||!m)&&F(void 0)),null))}function Ft(){ht(r)&&(E(r),r=At(e),Re(r)),er(r,{_chunkSteps:M=>{z(()=>{u=!1,f=!1;let $=M,fe=M;if(!d&&!m)try{fe=bi(M)}catch(Bt){ye(P._readableStreamController,Bt),ye(O._readableStreamController,Bt),F(Te(e,Bt));return}d||Fr(P._readableStreamController,$),m||Fr(O._readableStreamController,fe),s=!1,u?Me():f&&oe()})},_closeSteps:()=>{s=!1,d||rr(P._readableStreamController),m||rr(O._readableStreamController),P._readableStreamController._pendingPullIntos.length>0&&Br(P._readableStreamController,0),O._readableStreamController._pendingPullIntos.length>0&&Br(O._readableStreamController,0),(!d||!m)&&F(void 0)},_errorSteps:()=>{s=!1}})}function Xe(I,M){$e(r)&&(E(r),r=xi(e),Re(r));let $=M?O:P,fe=M?P:O;Di(r,I,1,{_chunkSteps:Mt=>{z(()=>{u=!1,f=!1;let Ut=M?m:d;if(M?d:m)Ut||Mr($._readableStreamController,Mt);else{let ps;try{ps=bi(Mt)}catch(po){ye($._readableStreamController,po),ye(fe._readableStreamController,po),F(Te(e,po));return}Ut||Mr($._readableStreamController,Mt),Fr(fe._readableStreamController,ps)}s=!1,u?Me():f&&oe()})},_closeSteps:Mt=>{s=!1;let Ut=M?m:d,sn=M?d:m;Ut||rr($._readableStreamController),sn||rr(fe._readableStreamController),Mt!==void 0&&(Ut||Mr($._readableStreamController,Mt),!sn&&fe._readableStreamController._pendingPullIntos.length>0&&Br(fe._readableStreamController,0)),(!Ut||!sn)&&F(void 0)},_errorSteps:()=>{s=!1}})}function Me(){if(s)return u=!0,b(void 0);s=!0;let I=Kn(P._readableStreamController);return I===null?Ft():Xe(I._view,!1),b(void 0)}function oe(){if(s)return f=!0,b(void 0);s=!0;let I=Kn(O._readableStreamController);return I===null?Ft():Xe(I._view,!0),b(void 0)}function ae(I){if(d=!0,T=I,m){let M=tr([T,x]),$=Te(e,M);F($)}return q}function be(I){if(m=!0,x=I,d){let M=tr([T,x]),$=Te(e,M);F($)}return q}function Ue(){}return P=ts(Ue,Me,ae),O=ts(Ue,oe,be),Re(r),[P,O]}function gc(e){return i(e)&&typeof e.getReader<"u"}function Sc(e){return gc(e)?_c(e.getReader()):wc(e)}function wc(e){let r,s=yi(e,"async"),u=n;function f(){let m;try{m=fu(s)}catch(x){return S(x)}let T=b(m);return L(T,x=>{if(!i(x))throw new TypeError("The promise returned by the iterator.next() method must fulfill with an object");if(du(x))yt(r._readableStreamController);else{let O=hu(x);Dt(r._readableStreamController,O)}})}function d(m){let T=s.iterator,x;try{x=Dr(T,"return")}catch(F){return S(F)}if(x===void 0)return b(void 0);let P;try{P=X(x,T,[m])}catch(F){return S(F)}let O=b(P);return L(O,F=>{if(!i(F))throw new TypeError("The promise returned by the iterator.return() method must fulfill with an object")})}return r=lr(u,f,d,0),r}function _c(e){let r,s=n;function u(){let d;try{d=e.read()}catch(m){return S(m)}return L(d,m=>{if(!i(m))throw new TypeError("The promise returned by the reader.read() method must fulfill with an object");if(m.done)yt(r._readableStreamController);else{let T=m.value;Dt(r._readableStreamController,T)}})}function f(d){try{return b(e.cancel(d))}catch(m){return S(m)}}return r=lr(s,u,f,0),r}function Ec(e,r){Ie(e,r);let s=e,u=s?.autoAllocateChunkSize,f=s?.cancel,d=s?.pull,m=s?.start,T=s?.type;return{autoAllocateChunkSize:u===void 0?void 0:Wn(u,`${r} has member 'autoAllocateChunkSize' that`),cancel:f===void 0?void 0:Tc(f,s,`${r} has member 'cancel' that`),pull:d===void 0?void 0:Rc(d,s,`${r} has member 'pull' that`),start:m===void 0?void 0:Cc(m,s,`${r} has member 'start' that`),type:T===void 0?void 0:Pc(T,`${r} has member 'type' that`)}}function Tc(e,r,s){return pe(e,s),u=>D(e,r,[u])}function Rc(e,r,s){return pe(e,s),u=>D(e,r,[u])}function Cc(e,r,s){return pe(e,s),u=>X(e,r,[u])}function Pc(e,r){if(e=`${e}`,e!=="bytes")throw new TypeError(`${r} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}function Ic(e,r){return Ie(e,r),{preventCancel:!!e?.preventCancel}}function es(e,r){Ie(e,r);let s=e?.preventAbort,u=e?.preventCancel,f=e?.preventClose,d=e?.signal;return d!==void 0&&Ac(d,`${r} has member 'signal' that`),{preventAbort:!!s,preventCancel:!!u,preventClose:!!f,signal:d}}function Ac(e,r){if(!Fu(e))throw new TypeError(`${r} is not an AbortSignal.`)}function vc(e,r){Ie(e,r);let s=e?.readable;Mn(s,"readable","ReadableWritablePair"),zn(s,`${r} has member 'readable' that`);let u=e?.writable;return Mn(u,"writable","ReadableWritablePair"),Ni(u,`${r} has member 'writable' that`),{readable:s,writable:u}}class ne{constructor(r={},s={}){r===void 0?r=null:ni(r,"First parameter");let u=zr(s,"Second parameter"),f=Ec(r,"First parameter");if(co(this),f.type==="bytes"){if(u.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");let d=or(u,0);Tu(this,f,d)}else{let d=Wr(u),m=or(u,1);mc(this,f,m,d)}}get locked(){if(!Ke(this))throw bt("locked");return Qe(this)}cancel(r=void 0){return Ke(this)?Qe(this)?S(new TypeError("Cannot cancel a stream that already has a reader")):Te(this,r):S(bt("cancel"))}getReader(r=void 0){if(!Ke(this))throw bt("getReader");return Cu(r,"First parameter").mode===void 0?At(this):xi(this)}pipeThrough(r,s={}){if(!Ke(this))throw bt("pipeThrough");De(r,1,"pipeThrough");let u=vc(r,"First parameter"),f=es(s,"Second parameter");if(Qe(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(Lt(u.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");let d=Zi(this,u.writable,f.preventClose,f.preventAbort,f.preventCancel,f.signal);return k(d),u.readable}pipeTo(r,s={}){if(!Ke(this))return S(bt("pipeTo"));if(r===void 0)return S("Parameter 1 is required in 'pipeTo'.");if(!xt(r))return S(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let u;try{u=es(s,"Second parameter")}catch(f){return S(f)}return Qe(this)?S(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):Lt(r)?S(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):Zi(this,r,u.preventClose,u.preventAbort,u.preventCancel,u.signal)}tee(){if(!Ke(this))throw bt("tee");let r=pc(this);return tr(r)}values(r=void 0){if(!Ke(this))throw bt("values");let s=Ic(r,"First parameter");return uu(this,s.preventCancel)}static from(r){return Sc(r)}}Object.defineProperties(ne,{from:{enumerable:!0}}),Object.defineProperties(ne.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),l(ne.from,"from"),l(ne.prototype.cancel,"cancel"),l(ne.prototype.getReader,"getReader"),l(ne.prototype.pipeThrough,"pipeThrough"),l(ne.prototype.pipeTo,"pipeTo"),l(ne.prototype.tee,"tee"),l(ne.prototype.values,"values"),typeof t.toStringTag=="symbol"&&Object.defineProperty(ne.prototype,t.toStringTag,{value:"ReadableStream",configurable:!0}),typeof t.asyncIterator=="symbol"&&Object.defineProperty(ne.prototype,t.asyncIterator,{value:ne.prototype.values,writable:!0,configurable:!0});function lr(e,r,s,u=1,f=()=>1){let d=Object.create(ne.prototype);co(d);let m=Object.create(Be.prototype);return Ji(d,m,e,r,s,u,f),d}function ts(e,r,s){let u=Object.create(ne.prototype);co(u);let f=Object.create(Ne.prototype);return vi(u,f,e,r,s,0,void 0),u}function co(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function Ke(e){return!i(e)||!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")?!1:e instanceof ne}function Qe(e){return e._reader!==void 0}function Te(e,r){if(e._disturbed=!0,e._state==="closed")return b(void 0);if(e._state==="errored")return S(e._storedError);ur(e);let s=e._reader;if(s!==void 0&&ht(s)){let f=s._readIntoRequests;s._readIntoRequests=new N,f.forEach(d=>{d._closeSteps(void 0)})}let u=e._readableStreamController[at](r);return L(u,n)}function ur(e){e._state="closed";let r=e._reader;if(r!==void 0&&(se(r),$e(r))){let s=r._readRequests;r._readRequests=new N,s.forEach(u=>{u._closeSteps()})}}function rs(e,r){e._state="errored",e._storedError=r;let s=e._reader;s!==void 0&&(G(s,r),$e(s)?ai(s,r):ki(s,r))}function bt(e){return new TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}function ns(e,r){Ie(e,r);let s=e?.highWaterMark;return Mn(s,"highWaterMark","QueuingStrategyInit"),{highWaterMark:Un(s)}}let os=e=>e.byteLength;l(os,"size");class Xr{constructor(r){De(r,1,"ByteLengthQueuingStrategy"),r=ns(r,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=r.highWaterMark}get highWaterMark(){if(!ss(this))throw is("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!ss(this))throw is("size");return os}}Object.defineProperties(Xr.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Xr.prototype,t.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});function is(e){return new TypeError(`ByteLengthQueuingStrategy.prototype.${e} can only be used on a ByteLengthQueuingStrategy`)}function ss(e){return!i(e)||!Object.prototype.hasOwnProperty.call(e,"_byteLengthQueuingStrategyHighWaterMark")?!1:e instanceof Xr}let as=()=>1;l(as,"size");class Jr{constructor(r){De(r,1,"CountQueuingStrategy"),r=ns(r,"First parameter"),this._countQueuingStrategyHighWaterMark=r.highWaterMark}get highWaterMark(){if(!us(this))throw ls("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!us(this))throw ls("size");return as}}Object.defineProperties(Jr.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Jr.prototype,t.toStringTag,{value:"CountQueuingStrategy",configurable:!0});function ls(e){return new TypeError(`CountQueuingStrategy.prototype.${e} can only be used on a CountQueuingStrategy`)}function us(e){return!i(e)||!Object.prototype.hasOwnProperty.call(e,"_countQueuingStrategyHighWaterMark")?!1:e instanceof Jr}function xc(e,r){Ie(e,r);let s=e?.cancel,u=e?.flush,f=e?.readableType,d=e?.start,m=e?.transform,T=e?.writableType;return{cancel:s===void 0?void 0:kc(s,e,`${r} has member 'cancel' that`),flush:u===void 0?void 0:Lc(u,e,`${r} has member 'flush' that`),readableType:f,start:d===void 0?void 0:Oc(d,e,`${r} has member 'start' that`),transform:m===void 0?void 0:Dc(m,e,`${r} has member 'transform' that`),writableType:T}}function Lc(e,r,s){return pe(e,s),u=>D(e,r,[u])}function Oc(e,r,s){return pe(e,s),u=>X(e,r,[u])}function Dc(e,r,s){return pe(e,s),(u,f)=>D(e,r,[u,f])}function kc(e,r,s){return pe(e,s),u=>D(e,r,[u])}class en{constructor(r={},s={},u={}){r===void 0&&(r=null);let f=zr(s,"Second parameter"),d=zr(u,"Third parameter"),m=xc(r,"First parameter");if(m.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(m.writableType!==void 0)throw new RangeError("Invalid writableType specified");let T=or(d,0),x=Wr(d),P=or(f,1),O=Wr(f),F,q=h(Re=>{F=Re});Nc(this,q,P,O,T,x),Bc(this,m),m.start!==void 0?F(m.start(this._transformStreamController)):F(void 0)}get readable(){if(!cs(this))throw ms("readable");return this._readable}get writable(){if(!cs(this))throw ms("writable");return this._writable}}Object.defineProperties(en.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(en.prototype,t.toStringTag,{value:"TransformStream",configurable:!0});function Nc(e,r,s,u,f,d){function m(){return r}function T(q){return Wc(e,q)}function x(q){return zc(e,q)}function P(){return qc(e)}e._writable=Uu(m,T,P,x,s,u);function O(){return jc(e)}function F(q){return $c(e,q)}e._readable=lr(m,O,F,f,d),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,tn(e,!0),e._transformStreamController=void 0}function cs(e){return!i(e)||!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")?!1:e instanceof en}function fs(e,r){Ee(e._readable._readableStreamController,r),fo(e,r)}function fo(e,r){nn(e._transformStreamController),ir(e._writable._writableStreamController,r),ho(e)}function ho(e){e._backpressure&&tn(e,!1)}function tn(e,r){e._backpressureChangePromise!==void 0&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=h(s=>{e._backpressureChangePromise_resolve=s}),e._backpressure=r}class Ze{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!rn(this))throw on("desiredSize");let r=this._controlledTransformStream._readable._readableStreamController;return uo(r)}enqueue(r=void 0){if(!rn(this))throw on("enqueue");ds(this,r)}error(r=void 0){if(!rn(this))throw on("error");Mc(this,r)}terminate(){if(!rn(this))throw on("terminate");Uc(this)}}Object.defineProperties(Ze.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),l(Ze.prototype.enqueue,"enqueue"),l(Ze.prototype.error,"error"),l(Ze.prototype.terminate,"terminate"),typeof t.toStringTag=="symbol"&&Object.defineProperty(Ze.prototype,t.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});function rn(e){return!i(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")?!1:e instanceof Ze}function Fc(e,r,s,u,f){r._controlledTransformStream=e,e._transformStreamController=r,r._transformAlgorithm=s,r._flushAlgorithm=u,r._cancelAlgorithm=f,r._finishPromise=void 0,r._finishPromise_resolve=void 0,r._finishPromise_reject=void 0}function Bc(e,r){let s=Object.create(Ze.prototype),u,f,d;r.transform!==void 0?u=m=>r.transform(m,s):u=m=>{try{return ds(s,m),b(void 0)}catch(T){return S(T)}},r.flush!==void 0?f=()=>r.flush(s):f=()=>b(void 0),r.cancel!==void 0?d=m=>r.cancel(m):d=()=>b(void 0),Fc(e,s,u,f,d)}function nn(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0,e._cancelAlgorithm=void 0}function ds(e,r){let s=e._controlledTransformStream,u=s._readable._readableStreamController;if(!kt(u))throw new TypeError("Readable side is not in a state that permits enqueue");try{Dt(u,r)}catch(d){throw fo(s,d),s._readable._storedError}hc(u)!==s._backpressure&&tn(s,!0)}function Mc(e,r){fs(e._controlledTransformStream,r)}function hs(e,r){let s=e._transformAlgorithm(r);return L(s,void 0,u=>{throw fs(e._controlledTransformStream,u),u})}function Uc(e){let r=e._controlledTransformStream,s=r._readable._readableStreamController;yt(s);let u=new TypeError("TransformStream terminated");fo(r,u)}function Wc(e,r){let s=e._transformStreamController;if(e._backpressure){let u=e._backpressureChangePromise;return L(u,()=>{let f=e._writable;if(f._state==="erroring")throw f._storedError;return hs(s,r)})}return hs(s,r)}function zc(e,r){let s=e._transformStreamController;if(s._finishPromise!==void 0)return s._finishPromise;let u=e._readable;s._finishPromise=h((d,m)=>{s._finishPromise_resolve=d,s._finishPromise_reject=m});let f=s._cancelAlgorithm(r);return nn(s),A(f,()=>(u._state==="errored"?Nt(s,u._storedError):(Ee(u._readableStreamController,r),mo(s)),null),d=>(Ee(u._readableStreamController,d),Nt(s,d),null)),s._finishPromise}function qc(e){let r=e._transformStreamController;if(r._finishPromise!==void 0)return r._finishPromise;let s=e._readable;r._finishPromise=h((f,d)=>{r._finishPromise_resolve=f,r._finishPromise_reject=d});let u=r._flushAlgorithm();return nn(r),A(u,()=>(s._state==="errored"?Nt(r,s._storedError):(yt(s._readableStreamController),mo(r)),null),f=>(Ee(s._readableStreamController,f),Nt(r,f),null)),r._finishPromise}function jc(e){return tn(e,!1),e._backpressureChangePromise}function $c(e,r){let s=e._transformStreamController;if(s._finishPromise!==void 0)return s._finishPromise;let u=e._writable;s._finishPromise=h((d,m)=>{s._finishPromise_resolve=d,s._finishPromise_reject=m});let f=s._cancelAlgorithm(r);return nn(s),A(f,()=>(u._state==="errored"?Nt(s,u._storedError):(ir(u._writableStreamController,r),ho(e),mo(s)),null),d=>(ir(u._writableStreamController,d),ho(e),Nt(s,d),null)),s._finishPromise}function on(e){return new TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function mo(e){e._finishPromise_resolve!==void 0&&(e._finishPromise_resolve(),e._finishPromise_resolve=void 0,e._finishPromise_reject=void 0)}function Nt(e,r){e._finishPromise_reject!==void 0&&(k(e._finishPromise),e._finishPromise_reject(r),e._finishPromise_resolve=void 0,e._finishPromise_reject=void 0)}function ms(e){return new TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}o.ByteLengthQueuingStrategy=Xr,o.CountQueuingStrategy=Jr,o.ReadableByteStreamController=Ne,o.ReadableStream=ne,o.ReadableStreamBYOBReader=Ge,o.ReadableStreamBYOBRequest=ct,o.ReadableStreamDefaultController=Be,o.ReadableStreamDefaultReader=je,o.TransformStream=en,o.TransformStreamDefaultController=Ze,o.WritableStream=Ye,o.WritableStreamDefaultController=Ot,o.WritableStreamDefaultWriter=Fe})});var Sl=Q(()=>{if(!globalThis.ReadableStream)try{let o=require("node:process"),{emitWarning:t}=o;try{o.emitWarning=()=>{},Object.assign(globalThis,require("node:stream/web")),o.emitWarning=t}catch(n){throw o.emitWarning=t,n}}catch{Object.assign(globalThis,gl())}try{let{Blob:o}=require("buffer");o&&!o.prototype.stream&&(o.prototype.stream=function(n){let i=0,a=this;return new ReadableStream({type:"bytes",async pull(l){let y=await a.slice(i,Math.min(a.size,i+65536)).arrayBuffer();i+=y.byteLength,l.enqueue(new Uint8Array(y)),i===a.size&&l.close()}})})}catch{}});async function*Vo(o,t=!0){for(let n of o)if("stream"in n)yield*n.stream();else if(ArrayBuffer.isView(n))if(t){let i=n.byteOffset,a=n.byteOffset+n.byteLength;for(;i!==a;){let l=Math.min(a-i,wl),c=n.buffer.slice(i,i+l);i+=c.byteLength,yield new Uint8Array(c)}}else yield n;else{let i=0,a=n;for(;i!==a.size;){let c=await a.slice(i,Math.min(a.size,i+wl)).arrayBuffer();i+=c.byteLength,yield new Uint8Array(c)}}}var ym,wl,_l,hd,We,Er=cr(()=>{ym=J(Sl(),1);wl=65536;_l=class Go{#e=[];#t="";#r=0;#n="transparent";constructor(t=[],n={}){if(typeof t!="object"||t===null)throw new TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.");if(typeof t[Symbol.iterator]!="function")throw new TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.");if(typeof n!="object"&&typeof n!="function")throw new TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");n===null&&(n={});let i=new TextEncoder;for(let l of t){let c;ArrayBuffer.isView(l)?c=new Uint8Array(l.buffer.slice(l.byteOffset,l.byteOffset+l.byteLength)):l instanceof ArrayBuffer?c=new Uint8Array(l.slice(0)):l instanceof Go?c=l:c=i.encode(`${l}`),this.#r+=ArrayBuffer.isView(c)?c.byteLength:c.size,this.#e.push(c)}this.#n=`${n.endings===void 0?"transparent":n.endings}`;let a=n.type===void 0?"":String(n.type);this.#t=/^[\x20-\x7E]*$/.test(a)?a:""}get size(){return this.#r}get type(){return this.#t}async text(){let t=new TextDecoder,n="";for await(let i of Vo(this.#e,!1))n+=t.decode(i,{stream:!0});return n+=t.decode(),n}async arrayBuffer(){let t=new Uint8Array(this.size),n=0;for await(let i of Vo(this.#e,!1))t.set(i,n),n+=i.length;return t.buffer}stream(){let t=Vo(this.#e,!0);return new globalThis.ReadableStream({type:"bytes",async pull(n){let i=await t.next();i.done?n.close():n.enqueue(i.value)},async cancel(){await t.return()}})}slice(t=0,n=this.size,i=""){let{size:a}=this,l=t<0?Math.max(a+t,0):Math.min(t,a),c=n<0?Math.max(a+n,0):Math.min(n,a),y=Math.max(c-l,0),p=this.#e,h=[],b=0;for(let v of p){if(b>=y)break;let A=ArrayBuffer.isView(v)?v.byteLength:v.size;if(l&&A<=l)l-=A,c-=A;else{let w;ArrayBuffer.isView(v)?(w=v.subarray(l,Math.min(A,c)),b+=w.byteLength):(w=v.slice(l,Math.min(A,c)),b+=w.size),c-=A,h.push(w),l=0}}let S=new Go([],{type:String(i).toLowerCase()});return S.#r=y,S.#e=h,S}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](t){return t&&typeof t=="object"&&typeof t.constructor=="function"&&(typeof t.stream=="function"||typeof t.arrayBuffer=="function")&&/^(Blob|File)$/.test(t[Symbol.toStringTag])}};Object.defineProperties(_l.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});hd=_l,We=hd});var md,pd,Yt,Yo=cr(()=>{Er();md=class extends We{#e=0;#t="";constructor(t,n,i={}){if(arguments.length<2)throw new TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`);super(t,i),i===null&&(i={});let a=i.lastModified===void 0?Date.now():Number(i.lastModified);Number.isNaN(a)||(this.#e=a),this.#t=String(n)}get name(){return this.#t}get lastModified(){return this.#e}get[Symbol.toStringTag](){return"File"}static[Symbol.hasInstance](t){return!!t&&t instanceof We&&/^(File)$/.test(t[Symbol.toStringTag])}},pd=md,Yt=pd});function Rl(o,t=We){var n=`${El()}${El()}`.replace(/\./g,"").slice(-28).padStart(32,"-"),i=[],a=`--${n}\r
Content-Disposition: form-data; name="`;return o.forEach((l,c)=>typeof l=="string"?i.push(a+Ko(c)+`"\r
\r
${l.replace(/\r(?!\n)|(?<!\r)\n/g,`\r
`)}\r
`):i.push(a+Ko(c)+`"; filename="${Ko(l.name,1)}"\r
Content-Type: ${l.type||"application/octet-stream"}\r
\r
`,l,`\r
`)),i.push(`--${n}--`),new t(i,{type:"multipart/form-data; boundary="+n})}var Tr,yd,bd,El,gd,Tl,Ko,_t,Et,Cn=cr(()=>{Er();Yo();({toStringTag:Tr,iterator:yd,hasInstance:bd}=Symbol),El=Math.random,gd="append,set,get,getAll,delete,keys,values,entries,forEach,constructor".split(","),Tl=(o,t,n)=>(o+="",/^(Blob|File)$/.test(t&&t[Tr])?[(n=n!==void 0?n+"":t[Tr]=="File"?t.name:"blob",o),t.name!==n||t[Tr]=="blob"?new Yt([t],n,t):t]:[o,t+""]),Ko=(o,t)=>(t?o:o.replace(/\r?\n|\r/g,`\r
`)).replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),_t=(o,t,n)=>{if(t.length<n)throw new TypeError(`Failed to execute '${o}' on 'FormData': ${n} arguments required, but only ${t.length} present.`)},Et=class{#e=[];constructor(...t){if(t.length)throw new TypeError("Failed to construct 'FormData': parameter 1 is not of type 'HTMLFormElement'.")}get[Tr](){return"FormData"}[yd](){return this.entries()}static[bd](t){return t&&typeof t=="object"&&t[Tr]==="FormData"&&!gd.some(n=>typeof t[n]!="function")}append(...t){_t("append",arguments,2),this.#e.push(Tl(...t))}delete(t){_t("delete",arguments,1),t+="",this.#e=this.#e.filter(([n])=>n!==t)}get(t){_t("get",arguments,1),t+="";for(var n=this.#e,i=n.length,a=0;a<i;a++)if(n[a][0]===t)return n[a][1];return null}getAll(t,n){return _t("getAll",arguments,1),n=[],t+="",this.#e.forEach(i=>i[0]===t&&n.push(i[1])),n}has(t){return _t("has",arguments,1),t+="",this.#e.some(n=>n[0]===t)}forEach(t,n){_t("forEach",arguments,1);for(var[i,a]of this)t.call(n,a,i,this)}set(...t){_t("set",arguments,2);var n=[],i=!0;t=Tl(...t),this.#e.forEach(a=>{a[0]===t[0]?i&&(i=!n.push(t)):n.push(a)}),i&&n.push(t),this.#e=n}*entries(){yield*this.#e}*keys(){for(var[t]of this)yield t}*values(){for(var[,t]of this)yield t}}});var vl=Q((vm,Al)=>{if(!globalThis.DOMException)try{let{MessageChannel:o}=require("worker_threads"),t=new o().port1,n=new ArrayBuffer;t.postMessage(n,[n,n])}catch(o){o.constructor.name==="DOMException"&&(globalThis.DOMException=o.constructor)}Al.exports=globalThis.DOMException});var In,Sd,Om,Zo=cr(()=>{In=require("node:fs"),Sd=J(vl(),1);Yo();Er();({stat:Om}=In.promises)});var Ll={};ys(Ll,{toFormData:()=>Pd});function Cd(o){let t=o.match(/\bfilename=("(.*?)"|([^()<>@,;:\\"/[\]?={}\s\t]+))($|;\s)/i);if(!t)return;let n=t[2]||t[3]||"",i=n.slice(n.lastIndexOf("\\")+1);return i=i.replace(/%22/g,'"'),i=i.replace(/&#(\d{4});/g,(a,l)=>String.fromCharCode(l)),i}async function Pd(o,t){if(!/multipart/i.test(t))throw new TypeError("Failed to fetch");let n=t.match(/boundary=(?:"([^"]+)"|([^;]+))/i);if(!n)throw new TypeError("no or bad content-type header, no multipart boundary");let i=new Xo(n[1]||n[2]),a,l,c,y,p,h,b=[],S=new Et,v=k=>{c+=L.decode(k,{stream:!0})},A=k=>{b.push(k)},w=()=>{let k=new Yt(b,h,{type:p});S.append(y,k)},W=()=>{S.append(y,c)},L=new TextDecoder("utf-8");L.decode(),i.onPartBegin=function(){i.onPartData=v,i.onPartEnd=W,a="",l="",c="",y="",p="",h=null,b.length=0},i.onHeaderField=function(k){a+=L.decode(k,{stream:!0})},i.onHeaderValue=function(k){l+=L.decode(k,{stream:!0})},i.onHeaderEnd=function(){if(l+=L.decode(),a=a.toLowerCase(),a==="content-disposition"){let k=l.match(/\bname=("([^"]*)"|([^()<>@,;:\\"/[\]?={}\s\t]+))/i);k&&(y=k[2]||k[3]||""),h=Cd(l),h&&(i.onPartData=A,i.onPartEnd=w)}else a==="content-type"&&(p=l);l="",a=""};for await(let k of o)i.write(k);return i.end(),S}var xe,H,xl,it,An,vn,wd,Cr,_d,Ed,Td,Rd,Tt,Xo,Ol=cr(()=>{Zo();Cn();xe=0,H={START_BOUNDARY:xe++,HEADER_FIELD_START:xe++,HEADER_FIELD:xe++,HEADER_VALUE_START:xe++,HEADER_VALUE:xe++,HEADER_VALUE_ALMOST_DONE:xe++,HEADERS_ALMOST_DONE:xe++,PART_DATA_START:xe++,PART_DATA:xe++,END:xe++},xl=1,it={PART_BOUNDARY:xl,LAST_BOUNDARY:xl*=2},An=10,vn=13,wd=32,Cr=45,_d=58,Ed=97,Td=122,Rd=o=>o|32,Tt=()=>{},Xo=class{constructor(t){this.index=0,this.flags=0,this.onHeaderEnd=Tt,this.onHeaderField=Tt,this.onHeadersEnd=Tt,this.onHeaderValue=Tt,this.onPartBegin=Tt,this.onPartData=Tt,this.onPartEnd=Tt,this.boundaryChars={},t=`\r
--`+t;let n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i),this.boundaryChars[n[i]]=!0;this.boundary=n,this.lookbehind=new Uint8Array(this.boundary.length+8),this.state=H.START_BOUNDARY}write(t){let n=0,i=t.length,a=this.index,{lookbehind:l,boundary:c,boundaryChars:y,index:p,state:h,flags:b}=this,S=this.boundary.length,v=S-1,A=t.length,w,W,L=D=>{this[D+"Mark"]=n},k=D=>{delete this[D+"Mark"]},z=(D,V,N,ie)=>{(V===void 0||V!==N)&&this[D](ie&&ie.subarray(V,N))},X=(D,V)=>{let N=D+"Mark";N in this&&(V?(z(D,this[N],n,t),delete this[N]):(z(D,this[N],t.length,t),this[N]=0))};for(n=0;n<i;n++)switch(w=t[n],h){case H.START_BOUNDARY:if(p===c.length-2){if(w===Cr)b|=it.LAST_BOUNDARY;else if(w!==vn)return;p++;break}else if(p-1===c.length-2){if(b&it.LAST_BOUNDARY&&w===Cr)h=H.END,b=0;else if(!(b&it.LAST_BOUNDARY)&&w===An)p=0,z("onPartBegin"),h=H.HEADER_FIELD_START;else return;break}w!==c[p+2]&&(p=-2),w===c[p+2]&&p++;break;case H.HEADER_FIELD_START:h=H.HEADER_FIELD,L("onHeaderField"),p=0;case H.HEADER_FIELD:if(w===vn){k("onHeaderField"),h=H.HEADERS_ALMOST_DONE;break}if(p++,w===Cr)break;if(w===_d){if(p===1)return;X("onHeaderField",!0),h=H.HEADER_VALUE_START;break}if(W=Rd(w),W<Ed||W>Td)return;break;case H.HEADER_VALUE_START:if(w===wd)break;L("onHeaderValue"),h=H.HEADER_VALUE;case H.HEADER_VALUE:w===vn&&(X("onHeaderValue",!0),z("onHeaderEnd"),h=H.HEADER_VALUE_ALMOST_DONE);break;case H.HEADER_VALUE_ALMOST_DONE:if(w!==An)return;h=H.HEADER_FIELD_START;break;case H.HEADERS_ALMOST_DONE:if(w!==An)return;z("onHeadersEnd"),h=H.PART_DATA_START;break;case H.PART_DATA_START:h=H.PART_DATA,L("onPartData");case H.PART_DATA:if(a=p,p===0){for(n+=v;n<A&&!(t[n]in y);)n+=S;n-=v,w=t[n]}if(p<c.length)c[p]===w?(p===0&&X("onPartData",!0),p++):p=0;else if(p===c.length)p++,w===vn?b|=it.PART_BOUNDARY:w===Cr?b|=it.LAST_BOUNDARY:p=0;else if(p-1===c.length)if(b&it.PART_BOUNDARY){if(p=0,w===An){b&=~it.PART_BOUNDARY,z("onPartEnd"),z("onPartBegin"),h=H.HEADER_FIELD_START;break}}else b&it.LAST_BOUNDARY&&w===Cr?(z("onPartEnd"),h=H.END,b=0):p=0;if(p>0)l[p-1]=w;else if(a>0){let D=new Uint8Array(l.buffer,l.byteOffset,l.byteLength);z("onPartData",0,a,D),a=0,L("onPartData"),n--}break;case H.END:break;default:throw new Error(`Unexpected state entered: ${h}`)}X("onHeaderField"),X("onHeaderValue"),X("onPartData"),this.index=p,this.state=h,this.flags=b}end(){if(this.state===H.HEADER_FIELD_START&&this.index===0||this.state===H.PART_DATA&&this.index===this.boundary.length)this.onPartEnd();else if(this.state!==H.END)throw new Error("MultipartParser.end(): stream ended unexpectedly")}}});var Md={};ys(Md,{default:()=>Bd});module.exports=Qc(Md);var Oe=require("@raycast/api");var Z=require("@raycast/api");var ja=require("node:buffer"),$a=J(require("node:path"),1),bn=J(require("node:child_process"),1),pr=J(require("node:process"),1),Ha=J(ia(),1);function Co(o){let t=typeof o=="string"?`
`:10,n=typeof o=="string"?"\r":13;return o[o.length-1]===t&&(o=o.slice(0,-1)),o[o.length-1]===n&&(o=o.slice(0,-1)),o}var fr=J(require("node:process"),1),qt=J(require("node:path"),1),sa=J(require("node:url"),1);function un(o={}){let{env:t=process.env,platform:n=process.platform}=o;return n!=="win32"?"PATH":Object.keys(t).reverse().find(i=>i.toUpperCase()==="PATH")||"Path"}function Rf(o={}){let{cwd:t=fr.default.cwd(),path:n=fr.default.env[un()],execPath:i=fr.default.execPath}=o,a,l=t instanceof URL?sa.default.fileURLToPath(t):t,c=qt.default.resolve(l),y=[];for(;a!==c;)y.push(qt.default.join(c,"node_modules/.bin")),a=c,c=qt.default.resolve(c,"..");return y.push(qt.default.resolve(l,i,"..")),[...y,n].join(qt.default.delimiter)}function aa({env:o=fr.default.env,...t}={}){o={...o};let n=un({env:o});return t.path=o[n],o[n]=Rf(t),o}var Cf=(o,t,n,i)=>{if(n==="length"||n==="prototype"||n==="arguments"||n==="caller")return;let a=Object.getOwnPropertyDescriptor(o,n),l=Object.getOwnPropertyDescriptor(t,n);!Pf(a,l)&&i||Object.defineProperty(o,n,l)},Pf=function(o,t){return o===void 0||o.configurable||o.writable===t.writable&&o.enumerable===t.enumerable&&o.configurable===t.configurable&&(o.writable||o.value===t.value)},If=(o,t)=>{let n=Object.getPrototypeOf(t);n!==Object.getPrototypeOf(o)&&Object.setPrototypeOf(o,n)},Af=(o,t)=>`/* Wrapped ${o}*/
${t}`,vf=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),xf=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name"),Lf=(o,t,n)=>{let i=n===""?"":`with ${n.trim()}() `,a=Af.bind(null,i,t.toString());Object.defineProperty(a,"name",xf),Object.defineProperty(o,"toString",{...vf,value:a})};function Po(o,t,{ignoreNonConfigurable:n=!1}={}){let{name:i}=o;for(let a of Reflect.ownKeys(t))Cf(o,t,a,n);return If(o,t),Lf(o,t,i),o}var cn=new WeakMap,la=(o,t={})=>{if(typeof o!="function")throw new TypeError("Expected a function");let n,i=0,a=o.displayName||o.name||"<anonymous>",l=function(...c){if(cn.set(l,++i),i===1)n=o.apply(this,c),o=null;else if(t.throw===!0)throw new Error(`Function \`${a}\` can only be called once`);return n};return Po(l,o),cn.set(l,i),l};la.callCount=o=>{if(!cn.has(o))throw new Error(`The given function \`${o.name}\` is not wrapped by the \`onetime\` package`);return cn.get(o)};var ua=la;var pa=require("node:os");var ca=function(){let o=da-fa+1;return Array.from({length:o},Of)},Of=function(o,t){return{name:`SIGRT${t+1}`,number:fa+t,action:"terminate",description:"Application-specific signal (realtime)",standard:"posix"}},fa=34,da=64;var ma=require("node:os");var ha=[{name:"SIGHUP",number:1,action:"terminate",description:"Terminal closed",standard:"posix"},{name:"SIGINT",number:2,action:"terminate",description:"User interruption with CTRL-C",standard:"ansi"},{name:"SIGQUIT",number:3,action:"core",description:"User interruption with CTRL-\\",standard:"posix"},{name:"SIGILL",number:4,action:"core",description:"Invalid machine instruction",standard:"ansi"},{name:"SIGTRAP",number:5,action:"core",description:"Debugger breakpoint",standard:"posix"},{name:"SIGABRT",number:6,action:"core",description:"Aborted",standard:"ansi"},{name:"SIGIOT",number:6,action:"core",description:"Aborted",standard:"bsd"},{name:"SIGBUS",number:7,action:"core",description:"Bus error due to misaligned, non-existing address or paging error",standard:"bsd"},{name:"SIGEMT",number:7,action:"terminate",description:"Command should be emulated but is not implemented",standard:"other"},{name:"SIGFPE",number:8,action:"core",description:"Floating point arithmetic error",standard:"ansi"},{name:"SIGKILL",number:9,action:"terminate",description:"Forced termination",standard:"posix",forced:!0},{name:"SIGUSR1",number:10,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGSEGV",number:11,action:"core",description:"Segmentation fault",standard:"ansi"},{name:"SIGUSR2",number:12,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGPIPE",number:13,action:"terminate",description:"Broken pipe or socket",standard:"posix"},{name:"SIGALRM",number:14,action:"terminate",description:"Timeout or timer",standard:"posix"},{name:"SIGTERM",number:15,action:"terminate",description:"Termination",standard:"ansi"},{name:"SIGSTKFLT",number:16,action:"terminate",description:"Stack is empty or overflowed",standard:"other"},{name:"SIGCHLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"posix"},{name:"SIGCLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"other"},{name:"SIGCONT",number:18,action:"unpause",description:"Unpaused",standard:"posix",forced:!0},{name:"SIGSTOP",number:19,action:"pause",description:"Paused",standard:"posix",forced:!0},{name:"SIGTSTP",number:20,action:"pause",description:'Paused using CTRL-Z or "suspend"',standard:"posix"},{name:"SIGTTIN",number:21,action:"pause",description:"Background process cannot read terminal input",standard:"posix"},{name:"SIGBREAK",number:21,action:"terminate",description:"User interruption with CTRL-BREAK",standard:"other"},{name:"SIGTTOU",number:22,action:"pause",description:"Background process cannot write to terminal output",standard:"posix"},{name:"SIGURG",number:23,action:"ignore",description:"Socket received out-of-band data",standard:"bsd"},{name:"SIGXCPU",number:24,action:"core",description:"Process timed out",standard:"bsd"},{name:"SIGXFSZ",number:25,action:"core",description:"File too big",standard:"bsd"},{name:"SIGVTALRM",number:26,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGPROF",number:27,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGWINCH",number:28,action:"ignore",description:"Terminal window size changed",standard:"bsd"},{name:"SIGIO",number:29,action:"terminate",description:"I/O is available",standard:"other"},{name:"SIGPOLL",number:29,action:"terminate",description:"Watched event",standard:"other"},{name:"SIGINFO",number:29,action:"ignore",description:"Request for process information",standard:"other"},{name:"SIGPWR",number:30,action:"terminate",description:"Device running out of power",standard:"systemv"},{name:"SIGSYS",number:31,action:"core",description:"Invalid system call",standard:"other"},{name:"SIGUNUSED",number:31,action:"terminate",description:"Invalid system call",standard:"other"}];var Io=function(){let o=ca();return[...ha,...o].map(Df)},Df=function({name:o,number:t,description:n,action:i,forced:a=!1,standard:l}){let{signals:{[o]:c}}=ma.constants,y=c!==void 0;return{name:o,number:y?c:t,description:n,supported:y,action:i,forced:a,standard:l}};var kf=function(){let o=Io();return Object.fromEntries(o.map(Nf))},Nf=function({name:o,number:t,description:n,supported:i,action:a,forced:l,standard:c}){return[o,{name:o,number:t,description:n,supported:i,action:a,forced:l,standard:c}]},ya=kf(),Ff=function(){let o=Io(),t=65,n=Array.from({length:t},(i,a)=>Bf(a,o));return Object.assign({},...n)},Bf=function(o,t){let n=Mf(o,t);if(n===void 0)return{};let{name:i,description:a,supported:l,action:c,forced:y,standard:p}=n;return{[o]:{name:i,number:o,description:a,supported:l,action:c,forced:y,standard:p}}},Mf=function(o,t){let n=t.find(({name:i})=>pa.constants.signals[i]===o);return n!==void 0?n:t.find(i=>i.number===o)},hh=Ff();var Uf=({timedOut:o,timeout:t,errorCode:n,signal:i,signalDescription:a,exitCode:l,isCanceled:c})=>o?`timed out after ${t} milliseconds`:c?"was canceled":n!==void 0?`failed with ${n}`:i!==void 0?`was killed with ${i} (${a})`:l!==void 0?`failed with exit code ${l}`:"failed",dr=({stdout:o,stderr:t,all:n,error:i,signal:a,exitCode:l,command:c,escapedCommand:y,timedOut:p,isCanceled:h,killed:b,parsed:{options:{timeout:S}}})=>{l=l===null?void 0:l,a=a===null?void 0:a;let v=a===void 0?void 0:ya[a].description,A=i&&i.code,W=`Command ${Uf({timedOut:p,timeout:S,errorCode:A,signal:a,signalDescription:v,exitCode:l,isCanceled:h})}: ${c}`,L=Object.prototype.toString.call(i)==="[object Error]",k=L?`${W}
${i.message}`:W,z=[k,t,o].filter(Boolean).join(`
`);return L?(i.originalMessage=i.message,i.message=z):i=new Error(z),i.shortMessage=k,i.command=c,i.escapedCommand=y,i.exitCode=l,i.signal=a,i.signalDescription=v,i.stdout=o,i.stderr=t,n!==void 0&&(i.all=n),"bufferedData"in i&&delete i.bufferedData,i.failed=!0,i.timedOut=!!p,i.isCanceled=h,i.killed=b&&!p,i};var fn=["stdin","stdout","stderr"],Wf=o=>fn.some(t=>o[t]!==void 0),ba=o=>{if(!o)return;let{stdio:t}=o;if(t===void 0)return fn.map(i=>o[i]);if(Wf(o))throw new Error(`It's not possible to provide \`stdio\` in combination with one of ${fn.map(i=>`\`${i}\``).join(", ")}`);if(typeof t=="string")return t;if(!Array.isArray(t))throw new TypeError(`Expected \`stdio\` to be of type \`string\` or \`Array\`, got \`${typeof t}\``);let n=Math.max(t.length,fn.length);return Array.from({length:n},(i,a)=>t[a])};var Ra=J(require("node:os"),1),Ca=J(Ta(),1),zf=1e3*5,Pa=(o,t="SIGTERM",n={})=>{let i=o(t);return qf(o,t,n,i),i},qf=(o,t,n,i)=>{if(!jf(t,n,i))return;let a=Hf(n),l=setTimeout(()=>{o("SIGKILL")},a);l.unref&&l.unref()},jf=(o,{forceKillAfterTimeout:t},n)=>$f(o)&&t!==!1&&n,$f=o=>o===Ra.default.constants.signals.SIGTERM||typeof o=="string"&&o.toUpperCase()==="SIGTERM",Hf=({forceKillAfterTimeout:o=!0})=>{if(o===!0)return zf;if(!Number.isFinite(o)||o<0)throw new TypeError(`Expected the \`forceKillAfterTimeout\` option to be a non-negative integer, got \`${o}\` (${typeof o})`);return o},Ia=(o,t)=>{o.kill()&&(t.isCanceled=!0)},Vf=(o,t,n)=>{o.kill(t),n(Object.assign(new Error("Timed out"),{timedOut:!0,signal:t}))},Aa=(o,{timeout:t,killSignal:n="SIGTERM"},i)=>{if(t===0||t===void 0)return i;let a,l=new Promise((y,p)=>{a=setTimeout(()=>{Vf(o,n,p)},t)}),c=i.finally(()=>{clearTimeout(a)});return Promise.race([l,c])},va=({timeout:o})=>{if(o!==void 0&&(!Number.isFinite(o)||o<0))throw new TypeError(`Expected the \`timeout\` option to be a non-negative integer, got \`${o}\` (${typeof o})`)},xa=async(o,{cleanup:t,detached:n},i)=>{if(!t||n)return i;let a=(0,Ca.default)(()=>{o.kill()});return i.finally(()=>{a()})};function xo(o){return o!==null&&typeof o=="object"&&typeof o.pipe=="function"}var ko=J(Da(),1),Fa=J(Na(),1),Ba=(o,t)=>{t!==void 0&&(xo(t)?t.pipe(o.stdin):o.stdin.end(t))},Ma=(o,{all:t})=>{if(!t||!o.stdout&&!o.stderr)return;let n=(0,Fa.default)();return o.stdout&&n.add(o.stdout),o.stderr&&n.add(o.stderr),n},Oo=async(o,t)=>{if(!(!o||t===void 0)){o.destroy();try{return await t}catch(n){return n.bufferedData}}},Do=(o,{encoding:t,buffer:n,maxBuffer:i})=>{if(!(!o||!n))return t?(0,ko.default)(o,{encoding:t,maxBuffer:i}):ko.default.buffer(o,{maxBuffer:i})},Ua=async({stdout:o,stderr:t,all:n},{encoding:i,buffer:a,maxBuffer:l},c)=>{let y=Do(o,{encoding:i,buffer:a,maxBuffer:l}),p=Do(t,{encoding:i,buffer:a,maxBuffer:l}),h=Do(n,{encoding:i,buffer:a,maxBuffer:l*2});try{return await Promise.all([c,y,p,h])}catch(b){return Promise.all([{error:b,signal:b.signal,timedOut:b.timedOut},Oo(o,y),Oo(t,p),Oo(n,h)])}},Wa=({input:o})=>{if(xo(o))throw new TypeError("The `input` option cannot be a stream in sync mode")};var ed=(async()=>{})().constructor.prototype,td=["then","catch","finally"].map(o=>[o,Reflect.getOwnPropertyDescriptor(ed,o)]),No=(o,t)=>{for(let[n,i]of td){let a=typeof t=="function"?(...l)=>Reflect.apply(i.value,t(),l):i.value.bind(t);Reflect.defineProperty(o,n,{...i,value:a})}return o},za=o=>new Promise((t,n)=>{o.on("exit",(i,a)=>{t({exitCode:i,signal:a})}),o.on("error",i=>{n(i)}),o.stdin&&o.stdin.on("error",i=>{n(i)})});var qa=(o,t=[])=>Array.isArray(t)?[o,...t]:[o],rd=/^[\w.-]+$/,nd=/"/g,od=o=>typeof o!="string"||rd.test(o)?o:`"${o.replace(nd,'\\"')}"`,Fo=(o,t)=>qa(o,t).join(" "),Bo=(o,t)=>qa(o,t).map(n=>od(n)).join(" ");var id=1e3*1e3*100,sd=({env:o,extendEnv:t,preferLocal:n,localDir:i,execPath:a})=>{let l=t?{...pr.default.env,...o}:o;return n?aa({env:l,cwd:i,execPath:a}):l},Va=(o,t,n={})=>{let i=Ha.default._parse(o,t,n);return o=i.command,t=i.args,n=i.options,n={maxBuffer:id,buffer:!0,stripFinalNewline:!0,extendEnv:!0,preferLocal:!1,localDir:n.cwd||pr.default.cwd(),execPath:pr.default.execPath,encoding:"utf8",reject:!0,cleanup:!0,all:!1,windowsHide:!0,...n},n.env=sd(n),n.stdio=ba(n),pr.default.platform==="win32"&&$a.default.basename(o,".exe")==="cmd"&&t.unshift("/q"),{file:o,args:t,options:n,parsed:i}},yr=(o,t,n)=>typeof t!="string"&&!ja.Buffer.isBuffer(t)?n===void 0?void 0:"":o.stripFinalNewline?Co(t):t;function Ga(o,t,n){let i=Va(o,t,n),a=Fo(o,t),l=Bo(o,t);va(i.options);let c;try{c=bn.default.spawn(i.file,i.args,i.options)}catch(A){let w=new bn.default.ChildProcess,W=Promise.reject(dr({error:A,stdout:"",stderr:"",all:"",command:a,escapedCommand:l,parsed:i,timedOut:!1,isCanceled:!1,killed:!1}));return No(w,W)}let y=za(c),p=Aa(c,i.options,y),h=xa(c,i.options,p),b={isCanceled:!1};c.kill=Pa.bind(null,c.kill.bind(c)),c.cancel=Ia.bind(null,c,b);let v=ua(async()=>{let[{error:A,exitCode:w,signal:W,timedOut:L},k,z,X]=await Ua(c,i.options,h),D=yr(i.options,k),V=yr(i.options,z),N=yr(i.options,X);if(A||w!==0||W!==null){let ie=dr({error:A,exitCode:w,signal:W,stdout:D,stderr:V,all:N,command:a,escapedCommand:l,parsed:i,timedOut:L,isCanceled:b.isCanceled||(i.options.signal?i.options.signal.aborted:!1),killed:c.killed});if(!i.options.reject)return ie;throw ie}return{command:a,escapedCommand:l,exitCode:0,stdout:D,stderr:V,all:N,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}});return Ba(c,i.options.input),c.all=Ma(c,i.options),No(c,v)}function Ya(o,t,n){let i=Va(o,t,n),a=Fo(o,t),l=Bo(o,t);Wa(i.options);let c;try{c=bn.default.spawnSync(i.file,i.args,i.options)}catch(h){throw dr({error:h,stdout:"",stderr:"",all:"",command:a,escapedCommand:l,parsed:i,timedOut:!1,isCanceled:!1,killed:!1})}let y=yr(i.options,c.stdout,c.error),p=yr(i.options,c.stderr,c.error);if(c.error||c.status!==0||c.signal!==null){let h=dr({stdout:y,stderr:p,error:c.error,signal:c.signal,exitCode:c.status,command:a,escapedCommand:l,parsed:i,timedOut:c.error&&c.error.code==="ETIMEDOUT",isCanceled:!1,killed:c.signal!==null});if(!i.options.reject)return h;throw h}return{command:a,escapedCommand:l,exitCode:0,stdout:y,stderr:p,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}}var ce=require("fs"),nu=require("path/posix");var br=require("@raycast/api");var Ka="https://bitwarden.com";var ee={PASSWORD_OPTIONS:"bw-generate-password-options",PASSWORD_ONE_TIME_WARNING:"bw-generate-password-warning-accepted",SESSION_TOKEN:"sessionToken",REPROMPT_HASH:"sessionRepromptHash",SERVER_URL:"cliServer",LAST_ACTIVITY_TIME:"lastActivityTime",VAULT_LOCK_REASON:"vaultLockReason",VAULT_FAVORITE_ORDER:"vaultFavoriteOrder",VAULT_LAST_STATUS:"lastVaultStatus"},Qa={TIMEOUT:"Vault timed out due to inactivity",MANUAL:"Manually locked by the user",SYSTEM_LOCK:"Screen was locked",SYSTEM_SLEEP:"System went to sleep",CLI_UPDATED:"Bitwarden has been updated. Please login again."};var Za={IV:"iv",VAULT:"vault",CURRENT_FOLDER_ID:"currentFolderId",SEND_TYPE_FILTER:"sendTypeFilter",CLI_VERSION:"cliVersion"},$h={1:br.Icon.Globe,3:br.Icon.CreditCard,4:br.Icon.Person,2:br.Icon.Document};var ld=require("@raycast/api");function Xa(o){return Object.entries(o).flatMap(([t,n])=>n?[`--${t}`,n]:[])}var Mo=require("@raycast/api");var ud={IMMEDIATELY:"0",ONE_MINUTE:"60000",FIVE_MINUTES:"300000",FIFTEEN_MINUTES:"900000",THIRTY_MINUTES:"1800000",ONE_HOUR:"3600000",FOUR_HOURS:"14400000",EIGHT_HOURS:"28800000",ONE_DAY:"86400000",NEVER:"-1",SYSTEM_LOCK:"-2",SYSTEM_SLEEP:"-3"},ve=Object.entries(ud).reduce((o,[t,n])=>(o[t]=parseInt(n),o),{});var cd={[ve.IMMEDIATELY]:"Immediately",[ve.ONE_MINUTE]:"1 Minute",[ve.FIVE_MINUTES]:"5 Minutes",[ve.FIFTEEN_MINUTES]:"15 Minutes",[ve.THIRTY_MINUTES]:"30 Minutes",[ve.ONE_HOUR]:"1 Hour",[ve.FOUR_HOURS]:"4 Hours",[ve.EIGHT_HOURS]:"8 Hours",[ve.ONE_DAY]:"1 Day"};var nm={1:"Login",3:"Card",4:"Identity",2:"Secure Note"};function Ja(){let{serverUrl:o}=(0,Mo.getPreferenceValues)();return o===""||o==="bitwarden.com"||o==="https://bitwarden.com"?"":o}var wt=class extends Error{constructor(t,n){super(t),this.stack=n}},gr=class extends wt{constructor(t,n){super(t,n)}};var gn=class extends gr{constructor(t,n){super(t??"Bitwarden CLI not found",n),this.name="InstalledCLINotFoundError",this.stack=n}};var Sn=class extends gr{constructor(t,n){super(t??"Vault is locked",n),this.name="VaultIsLockedError"}},Sr=class extends wt{constructor(t,n){super(t??"Not logged in",n),this.name="NotLoggedInError"}},Vt=class extends gr{constructor(t,n){super(t??"Failed do download Bitwarden CLI",n),this.name="EnsureCliBinError"}},wn=class extends wt{constructor(t,n){super(t??"Premium status is required to use this feature",n),this.name="PremiumFeatureError"}},wr=class extends wt{constructor(t,n){super(t??"This Send has a is protected by a password",n),this.name="SendNeedsPasswordError"}},_r=class extends wt{constructor(t,n){super(t??"The password you entered is invalid",n),this.name="SendInvalidPasswordError"}};function Je(o,t){try{return o()}catch{return t}}var el=o=>{if(o){if(typeof o=="string")return o;if(o instanceof Error){let{message:t,name:n}=o;return o.stack?o.stack:`${n}: ${t}`}return String(o)}};var vr=require("path"),Xt=require("fs/promises");var ot=require("fs"),Tn=require("fs/promises"),al=require("path"),ll=J(sl());function ul(o){return new Promise(t=>{let n=setInterval(()=>{Je(()=>{}),(0,ot.statSync)(o).isFile()&&(clearInterval(n),t())},300)})}async function cl(o,t){let n=new ll.default.async({file:o});(0,ot.existsSync)(t)||(0,ot.mkdirSync)(t,{recursive:!0}),await n.extract(null,t),await n.close()}async function fl(o,t){let n=!1;try{let i=await(0,Tn.readdir)(t);for await(let a of i)a.startsWith(o)&&await Je(async()=>{await(0,Tn.unlink)((0,al.join)(t,a)),n=!0})}catch{return!1}return n}function dl(...o){for(let t of o)Je(()=>(0,ot.unlinkSync)(t))}var hl=require("fs"),ml=require("crypto");function pl(o){try{return(0,ml.createHash)("sha256").update((0,hl.readFileSync)(o)).digest("hex")}catch{return null}}var Ql=require("fs"),Zl=require("fs/promises"),Xl=require("url");var Gl=J(require("node:http"),1),Yl=J(require("node:https"),1),Ct=J(require("node:zlib"),1),me=J(require("node:stream"),1),Ar=require("node:buffer");function dd(o){if(!/^data:/i.test(o))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');o=o.replace(/\r?\n/g,"");let t=o.indexOf(",");if(t===-1||t<=4)throw new TypeError("malformed data: URI");let n=o.substring(5,t).split(";"),i="",a=!1,l=n[0]||"text/plain",c=l;for(let b=1;b<n.length;b++)n[b]==="base64"?a=!0:n[b]&&(c+=`;${n[b]}`,n[b].indexOf("charset=")===0&&(i=n[b].substring(8)));!n[0]&&!i.length&&(c+=";charset=US-ASCII",i="US-ASCII");let y=a?"base64":"ascii",p=unescape(o.substring(t+1)),h=Buffer.from(p,y);return h.type=l,h.typeFull=c,h.charset=i,h}var yl=dd;var Se=J(require("node:stream"),1),qe=require("node:util"),de=require("node:buffer");Er();Cn();var ze=class extends Error{constructor(t,n){super(t),Error.captureStackTrace(this,this.constructor),this.type=n}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};var le=class extends ze{constructor(t,n,i){super(t,n),i&&(this.code=this.errno=i.code,this.erroredSysCall=i.syscall)}};var Pn=Symbol.toStringTag,Qo=o=>typeof o=="object"&&typeof o.append=="function"&&typeof o.delete=="function"&&typeof o.get=="function"&&typeof o.getAll=="function"&&typeof o.has=="function"&&typeof o.set=="function"&&typeof o.sort=="function"&&o[Pn]==="URLSearchParams",Rr=o=>o&&typeof o=="object"&&typeof o.arrayBuffer=="function"&&typeof o.type=="string"&&typeof o.stream=="function"&&typeof o.constructor=="function"&&/^(Blob|File)$/.test(o[Pn]),Cl=o=>typeof o=="object"&&(o[Pn]==="AbortSignal"||o[Pn]==="EventTarget"),Pl=(o,t)=>{let n=new URL(t).hostname,i=new URL(o).hostname;return n===i||n.endsWith(`.${i}`)},Il=(o,t)=>{let n=new URL(t).protocol,i=new URL(o).protocol;return n===i};var Id=(0,qe.promisify)(Se.default.pipeline),ue=Symbol("Body internals"),Le=class{constructor(t,{size:n=0}={}){let i=null;t===null?t=null:Qo(t)?t=de.Buffer.from(t.toString()):Rr(t)||de.Buffer.isBuffer(t)||(qe.types.isAnyArrayBuffer(t)?t=de.Buffer.from(t):ArrayBuffer.isView(t)?t=de.Buffer.from(t.buffer,t.byteOffset,t.byteLength):t instanceof Se.default||(t instanceof Et?(t=Rl(t),i=t.type.split("=")[1]):t=de.Buffer.from(String(t))));let a=t;de.Buffer.isBuffer(t)?a=Se.default.Readable.from(t):Rr(t)&&(a=Se.default.Readable.from(t.stream())),this[ue]={body:t,stream:a,boundary:i,disturbed:!1,error:null},this.size=n,t instanceof Se.default&&t.on("error",l=>{let c=l instanceof ze?l:new le(`Invalid response body while trying to fetch ${this.url}: ${l.message}`,"system",l);this[ue].error=c})}get body(){return this[ue].stream}get bodyUsed(){return this[ue].disturbed}async arrayBuffer(){let{buffer:t,byteOffset:n,byteLength:i}=await Jo(this);return t.slice(n,n+i)}async formData(){let t=this.headers.get("content-type");if(t.startsWith("application/x-www-form-urlencoded")){let i=new Et,a=new URLSearchParams(await this.text());for(let[l,c]of a)i.append(l,c);return i}let{toFormData:n}=await Promise.resolve().then(()=>(Ol(),Ll));return n(this.body,t)}async blob(){let t=this.headers&&this.headers.get("content-type")||this[ue].body&&this[ue].body.type||"",n=await this.arrayBuffer();return new We([n],{type:t})}async json(){let t=await this.text();return JSON.parse(t)}async text(){let t=await Jo(this);return new TextDecoder().decode(t)}buffer(){return Jo(this)}};Le.prototype.buffer=(0,qe.deprecate)(Le.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer");Object.defineProperties(Le.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0},data:{get:(0,qe.deprecate)(()=>{},"data doesn't exist, use json(), text(), arrayBuffer(), or body instead","https://github.com/node-fetch/node-fetch/issues/1000 (response)")}});async function Jo(o){if(o[ue].disturbed)throw new TypeError(`body used already for: ${o.url}`);if(o[ue].disturbed=!0,o[ue].error)throw o[ue].error;let{body:t}=o;if(t===null)return de.Buffer.alloc(0);if(!(t instanceof Se.default))return de.Buffer.alloc(0);let n=[],i=0;try{for await(let a of t){if(o.size>0&&i+a.length>o.size){let l=new le(`content size at ${o.url} over limit: ${o.size}`,"max-size");throw t.destroy(l),l}i+=a.length,n.push(a)}}catch(a){throw a instanceof ze?a:new le(`Invalid response body while trying to fetch ${o.url}: ${a.message}`,"system",a)}if(t.readableEnded===!0||t._readableState.ended===!0)try{return n.every(a=>typeof a=="string")?de.Buffer.from(n.join("")):de.Buffer.concat(n,i)}catch(a){throw new le(`Could not create Buffer from response body for ${o.url}: ${a.message}`,"system",a)}else throw new le(`Premature close of server response while trying to fetch ${o.url}`)}var Kt=(o,t)=>{let n,i,{body:a}=o[ue];if(o.bodyUsed)throw new Error("cannot clone body after it is used");return a instanceof Se.default&&typeof a.getBoundary!="function"&&(n=new Se.PassThrough({highWaterMark:t}),i=new Se.PassThrough({highWaterMark:t}),a.pipe(n),a.pipe(i),o[ue].stream=n,a=i),a},Ad=(0,qe.deprecate)(o=>o.getBoundary(),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167"),xn=(o,t)=>o===null?null:typeof o=="string"?"text/plain;charset=UTF-8":Qo(o)?"application/x-www-form-urlencoded;charset=UTF-8":Rr(o)?o.type||null:de.Buffer.isBuffer(o)||qe.types.isAnyArrayBuffer(o)||ArrayBuffer.isView(o)?null:o instanceof Et?`multipart/form-data; boundary=${t[ue].boundary}`:o&&typeof o.getBoundary=="function"?`multipart/form-data;boundary=${Ad(o)}`:o instanceof Se.default?null:"text/plain;charset=UTF-8",Dl=o=>{let{body:t}=o[ue];return t===null?0:Rr(t)?t.size:de.Buffer.isBuffer(t)?t.length:t&&typeof t.getLengthSync=="function"&&t.hasKnownLength&&t.hasKnownLength()?t.getLengthSync():null},kl=async(o,{body:t})=>{t===null?o.end():await Id(t,o)};var ei=require("node:util"),Pr=J(require("node:http"),1),Ln=typeof Pr.default.validateHeaderName=="function"?Pr.default.validateHeaderName:o=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(o)){let t=new TypeError(`Header name must be a valid HTTP token [${o}]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),t}},ti=typeof Pr.default.validateHeaderValue=="function"?Pr.default.validateHeaderValue:(o,t)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(t)){let n=new TypeError(`Invalid character in header content ["${o}"]`);throw Object.defineProperty(n,"code",{value:"ERR_INVALID_CHAR"}),n}},he=class o extends URLSearchParams{constructor(t){let n=[];if(t instanceof o){let i=t.raw();for(let[a,l]of Object.entries(i))n.push(...l.map(c=>[a,c]))}else if(t!=null)if(typeof t=="object"&&!ei.types.isBoxedPrimitive(t)){let i=t[Symbol.iterator];if(i==null)n.push(...Object.entries(t));else{if(typeof i!="function")throw new TypeError("Header pairs must be iterable");n=[...t].map(a=>{if(typeof a!="object"||ei.types.isBoxedPrimitive(a))throw new TypeError("Each header pair must be an iterable object");return[...a]}).map(a=>{if(a.length!==2)throw new TypeError("Each header pair must be a name/value tuple");return[...a]})}}else throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");return n=n.length>0?n.map(([i,a])=>(Ln(i),ti(i,String(a)),[String(i).toLowerCase(),String(a)])):void 0,super(n),new Proxy(this,{get(i,a,l){switch(a){case"append":case"set":return(c,y)=>(Ln(c),ti(c,String(y)),URLSearchParams.prototype[a].call(i,String(c).toLowerCase(),String(y)));case"delete":case"has":case"getAll":return c=>(Ln(c),URLSearchParams.prototype[a].call(i,String(c).toLowerCase()));case"keys":return()=>(i.sort(),new Set(URLSearchParams.prototype.keys.call(i)).keys());default:return Reflect.get(i,a,l)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(t){let n=this.getAll(t);if(n.length===0)return null;let i=n.join(", ");return/^content-encoding$/i.test(t)&&(i=i.toLowerCase()),i}forEach(t,n=void 0){for(let i of this.keys())Reflect.apply(t,n,[this.get(i),i,this])}*values(){for(let t of this.keys())yield this.get(t)}*entries(){for(let t of this.keys())yield[t,this.get(t)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((t,n)=>(t[n]=this.getAll(n),t),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((t,n)=>{let i=this.getAll(n);return n==="host"?t[n]=i[0]:t[n]=i.length>1?i:i[0],t},{})}};Object.defineProperties(he.prototype,["get","entries","forEach","values"].reduce((o,t)=>(o[t]={enumerable:!0},o),{}));function Nl(o=[]){return new he(o.reduce((t,n,i,a)=>(i%2===0&&t.push(a.slice(i,i+2)),t),[]).filter(([t,n])=>{try{return Ln(t),ti(t,String(n)),!0}catch{return!1}}))}var vd=new Set([301,302,303,307,308]),On=o=>vd.has(o);var Ce=Symbol("Response internals"),we=class o extends Le{constructor(t=null,n={}){super(t,n);let i=n.status!=null?n.status:200,a=new he(n.headers);if(t!==null&&!a.has("Content-Type")){let l=xn(t,this);l&&a.append("Content-Type",l)}this[Ce]={type:"default",url:n.url,status:i,statusText:n.statusText||"",headers:a,counter:n.counter,highWaterMark:n.highWaterMark}}get type(){return this[Ce].type}get url(){return this[Ce].url||""}get status(){return this[Ce].status}get ok(){return this[Ce].status>=200&&this[Ce].status<300}get redirected(){return this[Ce].counter>0}get statusText(){return this[Ce].statusText}get headers(){return this[Ce].headers}get highWaterMark(){return this[Ce].highWaterMark}clone(){return new o(Kt(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(t,n=302){if(!On(n))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new o(null,{headers:{location:new URL(t).toString()},status:n})}static error(){let t=new o(null,{status:0,statusText:""});return t[Ce].type="error",t}static json(t=void 0,n={}){let i=JSON.stringify(t);if(i===void 0)throw new TypeError("data is not JSON serializable");let a=new he(n&&n.headers);return a.has("content-type")||a.set("content-type","application/json"),new o(i,{...n,headers:a})}get[Symbol.toStringTag](){return"Response"}};Object.defineProperties(we.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});var $l=require("node:url"),Hl=require("node:util");var Fl=o=>{if(o.search)return o.search;let t=o.href.length-1,n=o.hash||(o.href[t]==="#"?"#":"");return o.href[t-n.length]==="?"?"?":""};var Ml=require("node:net");function Bl(o,t=!1){return o==null||(o=new URL(o),/^(about|blob|data):$/.test(o.protocol))?"no-referrer":(o.username="",o.password="",o.hash="",t&&(o.pathname="",o.search=""),o)}var Ul=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]),Wl="strict-origin-when-cross-origin";function zl(o){if(!Ul.has(o))throw new TypeError(`Invalid referrerPolicy: ${o}`);return o}function xd(o){if(/^(http|ws)s:$/.test(o.protocol))return!0;let t=o.host.replace(/(^\[)|(]$)/g,""),n=(0,Ml.isIP)(t);return n===4&&/^127\./.test(t)||n===6&&/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(t)?!0:o.host==="localhost"||o.host.endsWith(".localhost")?!1:o.protocol==="file:"}function Qt(o){return/^about:(blank|srcdoc)$/.test(o)||o.protocol==="data:"||/^(blob|filesystem):$/.test(o.protocol)?!0:xd(o)}function ql(o,{referrerURLCallback:t,referrerOriginCallback:n}={}){if(o.referrer==="no-referrer"||o.referrerPolicy==="")return null;let i=o.referrerPolicy;if(o.referrer==="about:client")return"no-referrer";let a=o.referrer,l=Bl(a),c=Bl(a,!0);l.toString().length>4096&&(l=c),t&&(l=t(l)),n&&(c=n(c));let y=new URL(o.url);switch(i){case"no-referrer":return"no-referrer";case"origin":return c;case"unsafe-url":return l;case"strict-origin":return Qt(l)&&!Qt(y)?"no-referrer":c.toString();case"strict-origin-when-cross-origin":return l.origin===y.origin?l:Qt(l)&&!Qt(y)?"no-referrer":c;case"same-origin":return l.origin===y.origin?l:"no-referrer";case"origin-when-cross-origin":return l.origin===y.origin?l:c;case"no-referrer-when-downgrade":return Qt(l)&&!Qt(y)?"no-referrer":l;default:throw new TypeError(`Invalid referrerPolicy: ${i}`)}}function jl(o){let t=(o.get("referrer-policy")||"").split(/[,\s]+/),n="";for(let i of t)i&&Ul.has(i)&&(n=i);return n}var re=Symbol("Request internals"),Ir=o=>typeof o=="object"&&typeof o[re]=="object",Ld=(0,Hl.deprecate)(()=>{},".data is not a valid RequestInit property, use .body instead","https://github.com/node-fetch/node-fetch/issues/1000 (request)"),Rt=class o extends Le{constructor(t,n={}){let i;if(Ir(t)?i=new URL(t.url):(i=new URL(t),t={}),i.username!==""||i.password!=="")throw new TypeError(`${i} is an url with embedded credentials.`);let a=n.method||t.method||"GET";if(/^(delete|get|head|options|post|put)$/i.test(a)&&(a=a.toUpperCase()),!Ir(n)&&"data"in n&&Ld(),(n.body!=null||Ir(t)&&t.body!==null)&&(a==="GET"||a==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let l=n.body?n.body:Ir(t)&&t.body!==null?Kt(t):null;super(l,{size:n.size||t.size||0});let c=new he(n.headers||t.headers||{});if(l!==null&&!c.has("Content-Type")){let h=xn(l,this);h&&c.set("Content-Type",h)}let y=Ir(t)?t.signal:null;if("signal"in n&&(y=n.signal),y!=null&&!Cl(y))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");let p=n.referrer==null?t.referrer:n.referrer;if(p==="")p="no-referrer";else if(p){let h=new URL(p);p=/^about:(\/\/)?client$/.test(h)?"client":h}else p=void 0;this[re]={method:a,redirect:n.redirect||t.redirect||"follow",headers:c,parsedURL:i,signal:y,referrer:p},this.follow=n.follow===void 0?t.follow===void 0?20:t.follow:n.follow,this.compress=n.compress===void 0?t.compress===void 0?!0:t.compress:n.compress,this.counter=n.counter||t.counter||0,this.agent=n.agent||t.agent,this.highWaterMark=n.highWaterMark||t.highWaterMark||16384,this.insecureHTTPParser=n.insecureHTTPParser||t.insecureHTTPParser||!1,this.referrerPolicy=n.referrerPolicy||t.referrerPolicy||""}get method(){return this[re].method}get url(){return(0,$l.format)(this[re].parsedURL)}get headers(){return this[re].headers}get redirect(){return this[re].redirect}get signal(){return this[re].signal}get referrer(){if(this[re].referrer==="no-referrer")return"";if(this[re].referrer==="client")return"about:client";if(this[re].referrer)return this[re].referrer.toString()}get referrerPolicy(){return this[re].referrerPolicy}set referrerPolicy(t){this[re].referrerPolicy=zl(t)}clone(){return new o(this)}get[Symbol.toStringTag](){return"Request"}};Object.defineProperties(Rt.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0},referrer:{enumerable:!0},referrerPolicy:{enumerable:!0}});var Vl=o=>{let{parsedURL:t}=o[re],n=new he(o[re].headers);n.has("Accept")||n.set("Accept","*/*");let i=null;if(o.body===null&&/^(post|put)$/i.test(o.method)&&(i="0"),o.body!==null){let y=Dl(o);typeof y=="number"&&!Number.isNaN(y)&&(i=String(y))}i&&n.set("Content-Length",i),o.referrerPolicy===""&&(o.referrerPolicy=Wl),o.referrer&&o.referrer!=="no-referrer"?o[re].referrer=ql(o):o[re].referrer="no-referrer",o[re].referrer instanceof URL&&n.set("Referer",o.referrer),n.has("User-Agent")||n.set("User-Agent","node-fetch"),o.compress&&!n.has("Accept-Encoding")&&n.set("Accept-Encoding","gzip, deflate, br");let{agent:a}=o;typeof a=="function"&&(a=a(t));let l=Fl(t),c={path:t.pathname+l,method:o.method,headers:n[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:o.insecureHTTPParser,agent:a};return{parsedURL:t,options:c}};var Dn=class extends ze{constructor(t,n="aborted"){super(t,n)}};Cn();Zo();var Od=new Set(["data:","http:","https:"]);async function kn(o,t){return new Promise((n,i)=>{let a=new Rt(o,t),{parsedURL:l,options:c}=Vl(a);if(!Od.has(l.protocol))throw new TypeError(`node-fetch cannot load ${o}. URL scheme "${l.protocol.replace(/:$/,"")}" is not supported.`);if(l.protocol==="data:"){let w=yl(a.url),W=new we(w,{headers:{"Content-Type":w.typeFull}});n(W);return}let y=(l.protocol==="https:"?Yl.default:Gl.default).request,{signal:p}=a,h=null,b=()=>{let w=new Dn("The operation was aborted.");i(w),a.body&&a.body instanceof me.default.Readable&&a.body.destroy(w),!(!h||!h.body)&&h.body.emit("error",w)};if(p&&p.aborted){b();return}let S=()=>{b(),A()},v=y(l.toString(),c);p&&p.addEventListener("abort",S);let A=()=>{v.abort(),p&&p.removeEventListener("abort",S)};v.on("error",w=>{i(new le(`request to ${a.url} failed, reason: ${w.message}`,"system",w)),A()}),Dd(v,w=>{h&&h.body&&h.body.destroy(w)}),process.version<"v14"&&v.on("socket",w=>{let W;w.prependListener("end",()=>{W=w._eventsCount}),w.prependListener("close",L=>{if(h&&W<w._eventsCount&&!L){let k=new Error("Premature close");k.code="ERR_STREAM_PREMATURE_CLOSE",h.body.emit("error",k)}})}),v.on("response",w=>{v.setTimeout(0);let W=Nl(w.rawHeaders);if(On(w.statusCode)){let D=W.get("Location"),V=null;try{V=D===null?null:new URL(D,a.url)}catch{if(a.redirect!=="manual"){i(new le(`uri requested responds with an invalid redirect URL: ${D}`,"invalid-redirect")),A();return}}switch(a.redirect){case"error":i(new le(`uri requested responds with a redirect, redirect mode is set to error: ${a.url}`,"no-redirect")),A();return;case"manual":break;case"follow":{if(V===null)break;if(a.counter>=a.follow){i(new le(`maximum redirect reached at: ${a.url}`,"max-redirect")),A();return}let N={headers:new he(a.headers),follow:a.follow,counter:a.counter+1,agent:a.agent,compress:a.compress,method:a.method,body:Kt(a),signal:a.signal,size:a.size,referrer:a.referrer,referrerPolicy:a.referrerPolicy};if(!Pl(a.url,V)||!Il(a.url,V))for(let st of["authorization","www-authenticate","cookie","cookie2"])N.headers.delete(st);if(w.statusCode!==303&&a.body&&t.body instanceof me.default.Readable){i(new le("Cannot follow redirect with body being a readable stream","unsupported-redirect")),A();return}(w.statusCode===303||(w.statusCode===301||w.statusCode===302)&&a.method==="POST")&&(N.method="GET",N.body=void 0,N.headers.delete("content-length"));let ie=jl(W);ie&&(N.referrerPolicy=ie),n(kn(new Rt(V,N))),A();return}default:return i(new TypeError(`Redirect option '${a.redirect}' is not a valid value of RequestRedirect`))}}p&&w.once("end",()=>{p.removeEventListener("abort",S)});let L=(0,me.pipeline)(w,new me.PassThrough,D=>{D&&i(D)});process.version<"v12.10"&&w.on("aborted",S);let k={url:a.url,status:w.statusCode,statusText:w.statusMessage,headers:W,size:a.size,counter:a.counter,highWaterMark:a.highWaterMark},z=W.get("Content-Encoding");if(!a.compress||a.method==="HEAD"||z===null||w.statusCode===204||w.statusCode===304){h=new we(L,k),n(h);return}let X={flush:Ct.default.Z_SYNC_FLUSH,finishFlush:Ct.default.Z_SYNC_FLUSH};if(z==="gzip"||z==="x-gzip"){L=(0,me.pipeline)(L,Ct.default.createGunzip(X),D=>{D&&i(D)}),h=new we(L,k),n(h);return}if(z==="deflate"||z==="x-deflate"){let D=(0,me.pipeline)(w,new me.PassThrough,V=>{V&&i(V)});D.once("data",V=>{(V[0]&15)===8?L=(0,me.pipeline)(L,Ct.default.createInflate(),N=>{N&&i(N)}):L=(0,me.pipeline)(L,Ct.default.createInflateRaw(),N=>{N&&i(N)}),h=new we(L,k),n(h)}),D.once("end",()=>{h||(h=new we(L,k),n(h))});return}if(z==="br"){L=(0,me.pipeline)(L,Ct.default.createBrotliDecompress(),D=>{D&&i(D)}),h=new we(L,k),n(h);return}h=new we(L,k),n(h)}),kl(v,a).catch(i)})}function Dd(o,t){let n=Ar.Buffer.from(`0\r
\r
`),i=!1,a=!1,l;o.on("response",c=>{let{headers:y}=c;i=y["transfer-encoding"]==="chunked"&&!y["content-length"]}),o.on("socket",c=>{let y=()=>{if(i&&!a){let h=new Error("Premature close");h.code="ERR_STREAM_PREMATURE_CLOSE",t(h)}},p=h=>{a=Ar.Buffer.compare(h.slice(-5),n)===0,!a&&l&&(a=Ar.Buffer.compare(l.slice(-3),n.slice(0,3))===0&&Ar.Buffer.compare(h.slice(-2),n.slice(3))===0),l=h};c.prependListener("close",y),c.on("data",p),o.on("close",()=>{c.removeListener("close",y),c.removeListener("data",p)})})}var Kl=require("@raycast/api");var kd={logs:new Map,set:(o,t)=>{Nn.logs.set(new Date,{message:o,error:t})},clear:()=>Nn.logs.clear(),toString:()=>{let o="";return Nn.logs.forEach((t,n)=>{o.length>0&&(o+=`

`),o+=`[${n.toISOString()}] ${t.message}`,t.error&&(o+=`: ${el(t.error)}`)}),o}},Nn=Object.freeze(kd),j=(o,t)=>{let n=Array.isArray(o)?o.filter(Boolean).join(" "):o||"Captured exception";Nn.set(n,t),Kl.environment.isDevelopment&&console.error(n,t)};function Jl(o,t,n){return new Promise((i,a)=>{let l=(0,Xl.parse)(o);kn(l.href).then(c=>{if(!c.ok)throw new Error(`Response status ${c.status}: ${c.statusText}`);if(!c.body)throw new Error("No response body");let y=(0,Ql.createWriteStream)(t),p=parseInt(c.headers.get("content-length")||"0",10);if(p===0)throw new Error("Invalid file size");let h=0;c.body.on("data",b=>{y.write(b),h+=b.length,n?.(Math.floor(h/p*100))}),c.body.on("end",()=>{y.on("finish",i),y.end()}),c.body.on("error",async b=>{y.close(),await(0,Zl.unlink)(t),j(`Failed to download file ${o}`,b),a(b)})}).catch(a)})}function eu(o,t){return{...o,...t,file:t.file?{...o.file,...t.file}:o.file,text:t.text?{...o.text,...t.text}:o.text}}var tu=require("@raycast/api"),ru=new tu.Cache({namespace:"bw-cache"});var{supportPath:Pt}=Z.environment,Nd="2",Fn=(()=>{let o=(0,vr.join)(Pt,`bw-bin-download-error-${Nd}.log`);return{logError:t=>Je(()=>(0,ce.writeFileSync)(o,t?.message??"Unexpected error")),clearError:()=>Je(()=>(0,ce.unlinkSync)(o)),hasError:()=>Je(()=>(0,ce.existsSync)(o),!1)}})(),Zt={version:"2024.2.0",sha256:"fd80ffefd4686e677d7c8720258b3c92559b65b890519b1327cd4bb45887dde8",downloadPage:"https://github.com/bitwarden/clients/releases",path:{arm64:"/opt/homebrew/bin/bw",x64:"/usr/local/bin/bw",get downloadedBin(){return(0,vr.join)(Pt,Zt.binFilename)},get installedBin(){return process.arch==="arm64"?this.arm64:this.x64},get bin(){if(process.arch==="arm64"){let o=new Z.Cache;try{if(!(0,ce.existsSync)(this.downloadedBin))throw new Error("No downloaded bin");return o.get("downloadedBinWorks")==="true"?this.downloadedBin:(Ya(this.downloadedBin,["--version"]),o.set("downloadedBinWorks","true"),this.downloadedBin)}catch{return o.set("downloadedBinWorks","false"),this.installedBin}}return Fn.hasError()?this.installedBin:this.downloadedBin}},get binFilename(){return`bw-${this.version}`},get downloadUrl(){return`${this.downloadPage}/download/cli-v${this.version}/bw-macos-${this.version}.zip`},checkHashMatchesFile:function(o){return pl(o)===this.sha256}},Bn=class{constructor(t){this.actionListeners=new Map;this.preferences=(0,Z.getPreferenceValues)();this.wasCliUpdated=!1;this.showToast=async t=>{if(this.toastInstance){let n={message:this.toastInstance.message,title:this.toastInstance.title,primaryAction:this.toastInstance.primaryAction,secondaryAction:this.toastInstance.secondaryAction};return t.style&&(this.toastInstance.style=t.style),this.toastInstance.message=t.message,this.toastInstance.title=t.title,this.toastInstance.primaryAction=t.primaryAction,this.toastInstance.secondaryAction=t.secondaryAction,await this.toastInstance.show(),Object.assign(this.toastInstance,{restore:async()=>{await this.showToast(n)}})}else{let n=await(0,Z.showToast)(t);return Object.assign(n,{restore:()=>n.hide()})}};let{cliPath:n,clientId:i,clientSecret:a,serverCertsPath:l}=this.preferences,c=Ja();this.toastInstance=t,this.cliPath=n||Zt.path.bin,this.env={BITWARDENCLI_APPDATA_DIR:Pt,BW_CLIENTSECRET:a.trim(),BW_CLIENTID:i.trim(),PATH:(0,nu.dirname)(process.execPath),...c&&l?{NODE_EXTRA_CA_CERTS:l}:{}},this.initPromise=(async()=>{await this.ensureCliBinary(),this.cacheCliVersion(),await this.checkServerUrl(c)})()}async ensureCliBinary(){if(this.checkCliBinIsReady(this.cliPath))return;if(this.cliPath===this.preferences.cliPath||this.cliPath===Zt.path.installedBin)throw new gn(`Bitwarden CLI not found at ${this.cliPath}`);Fn.hasError()&&Fn.clearError();let t=await fl("bw-",Pt),n=await this.showToast({title:`${t?"Updating":"Initializing"} Bitwarden CLI`,style:Z.Toast.Style.Animated,primaryAction:{title:"Open Download Page",onAction:()=>(0,Z.open)(Zt.downloadPage)}}),a=(0,vr.join)(Pt,"bw.zip");try{try{if(n.message="Downloading...",await Jl(Zt.downloadUrl,a,l=>n.message=`Downloading ${l}%`),!Zt.checkHashMatchesFile(a))throw new Vt("Binary hash does not match")}catch(l){throw n.title="Failed to download Bitwarden CLI",l}try{n.message="Extracting...",await cl(a,Pt);let l=(0,vr.join)(Pt,"bw");await ul(l),await(0,Xt.rename)(l,this.cliPath),await(0,Xt.chmod)(this.cliPath,"755"),await(0,Xt.rm)(a,{force:!0}),this.wasCliUpdated=!0}catch(l){throw n.title="Failed to extract Bitwarden CLI",l}await n.hide()}catch(l){throw n.message=l instanceof Vt?l.message:"Please try again",n.style=Z.Toast.Style.Failure,dl(a,this.cliPath),Fn.logError(l),l instanceof Error?new Vt(`${l.name}: ${l.message}`,l.stack):l}finally{await n.restore()}}cacheCliVersion(){this.getVersion().then(({error:t,result:n})=>{t||ru.set(Za.CLI_VERSION,n)})}checkCliBinIsReady(t){try{return(0,ce.existsSync)(this.cliPath)?((0,ce.accessSync)(t,ce.constants.X_OK),!0):!1}catch{return(0,ce.chmodSync)(t,"755"),!0}}setSessionToken(t){this.env={...this.env,BW_SESSION:t}}clearSessionToken(){delete this.env.BW_SESSION}withSession(t){return this.tempSessionToken=t,this}async initialize(){return await this.initPromise,this}async checkServerUrl(t){if((await Z.LocalStorage.getItem(ee.SERVER_URL)||"")===t)return;let i=await this.showToast({style:Z.Toast.Style.Animated,title:"Switching server...",message:"Bitwarden server preference changed"});try{try{await this.logout()}catch{}await this.exec(["config","server",t||Ka],{resetVaultTimeout:!1}),await Z.LocalStorage.setItem(ee.SERVER_URL,t),i.style=Z.Toast.Style.Success,i.title="Success",i.message="Bitwarden server changed"}catch(a){i.style=Z.Toast.Style.Failure,i.title="Failed to switch server",a instanceof Error?i.message=a.message:i.message="Unknown error occurred"}finally{await i.restore()}}async exec(t,n){let{abortController:i,input:a="",resetVaultTimeout:l}=n??{},c=this.env;this.tempSessionToken&&(c={...c,BW_SESSION:this.tempSessionToken},this.tempSessionToken=void 0);let y=await Ga(this.cliPath,t,{input:a,env:c,signal:i?.signal});if(this.isPromptWaitingForMasterPassword(y))throw await this.lock(),new Sn;return l&&await Z.LocalStorage.setItem(ee.LAST_ACTIVITY_TIME,new Date().toISOString()),y}async getVersion(){try{let{stdout:t}=await this.exec(["--version"],{resetVaultTimeout:!1});return{result:t}}catch(t){j("Failed to get cli version",t);let{error:n}=await this.handleCommonErrors(t);if(!n)throw t;return{error:n}}}async login(){try{return await this.exec(["login","--apikey"],{resetVaultTimeout:!0}),await this.saveLastVaultStatus("login","unlocked"),await this.callActionListeners("login"),{result:void 0}}catch(t){j("Failed to login",t);let{error:n}=await this.handleCommonErrors(t);if(!n)throw t;return{error:n}}}async logout(t){let{reason:n,immediate:i=!1}=t??{};try{return i&&await this.handlePostLogout(n),await this.exec(["logout"],{resetVaultTimeout:!1}),await this.saveLastVaultStatus("logout","unauthenticated"),i||await this.handlePostLogout(n),{result:void 0}}catch(a){j("Failed to logout",a);let{error:l}=await this.handleCommonErrors(a);if(!l)throw a;return{error:l}}}async lock(t){let{reason:n,checkVaultStatus:i=!1,immediate:a=!1}=t??{};try{if(a&&await this.callActionListeners("lock",n),i){let{error:l,result:c}=await this.status();if(l)throw l;if(c.status==="unauthenticated")return{error:new Sr("Not logged in")}}return await this.exec(["lock"],{resetVaultTimeout:!1}),await this.saveLastVaultStatus("lock","locked"),a||await this.callActionListeners("lock",n),{result:void 0}}catch(l){j("Failed to lock vault",l);let{error:c}=await this.handleCommonErrors(l);if(!c)throw l;return{error:c}}}async unlock(t){try{let{stdout:n}=await this.exec(["unlock",t,"--raw"],{resetVaultTimeout:!0});return this.setSessionToken(n),await this.saveLastVaultStatus("unlock","unlocked"),await this.callActionListeners("unlock",t,n),{result:n}}catch(n){j("Failed to unlock vault",n);let{error:i}=await this.handleCommonErrors(n);if(!i)throw n;return{error:i}}}async sync(){try{return await this.exec(["sync"],{resetVaultTimeout:!0}),{result:void 0}}catch(t){j("Failed to sync vault",t);let{error:n}=await this.handleCommonErrors(t);if(!n)throw t;return{error:n}}}async getItem(t){try{let{stdout:n}=await this.exec(["get","item",t],{resetVaultTimeout:!0});return{result:JSON.parse(n)}}catch(n){j("Failed to get item",n);let{error:i}=await this.handleCommonErrors(n);if(!i)throw n;return{error:i}}}async listItems(){try{let{stdout:t}=await this.exec(["list","items"],{resetVaultTimeout:!0});return{result:JSON.parse(t).filter(i=>!!i.name)}}catch(t){j("Failed to list items",t);let{error:n}=await this.handleCommonErrors(t);if(!n)throw t;return{error:n}}}async listFolders(){try{let{stdout:t}=await this.exec(["list","folders"],{resetVaultTimeout:!0});return{result:JSON.parse(t)}}catch(t){j("Failed to list folder",t);let{error:n}=await this.handleCommonErrors(t);if(!n)throw t;return{error:n}}}async createFolder(t){try{let{error:n,result:i}=await this.getTemplate("folder");if(n)throw n;i.name=t;let{result:a,error:l}=await this.encode(JSON.stringify(i));if(l)throw l;return await this.exec(["create","folder",a],{resetVaultTimeout:!0}),{result:void 0}}catch(n){j("Failed to create folder",n);let{error:i}=await this.handleCommonErrors(n);if(!i)throw n;return{error:i}}}async getTotp(t){try{let{stdout:n}=await this.exec(["get","totp",t],{resetVaultTimeout:!0});return{result:n}}catch(n){j("Failed to get TOTP",n);let{error:i}=await this.handleCommonErrors(n);if(!i)throw n;return{error:i}}}async status(){try{let{stdout:t}=await this.exec(["status"],{resetVaultTimeout:!1});return{result:JSON.parse(t)}}catch(t){j("Failed to get status",t);let{error:n}=await this.handleCommonErrors(t);if(!n)throw t;return{error:n}}}async checkLockStatus(){try{return await this.exec(["unlock","--check"],{resetVaultTimeout:!1}),await this.saveLastVaultStatus("checkLockStatus","unlocked"),"unlocked"}catch(t){return j("Failed to check lock status",t),t.stderr==="Vault is locked."?(await this.saveLastVaultStatus("checkLockStatus","locked"),"locked"):(await this.saveLastVaultStatus("checkLockStatus","unauthenticated"),"unauthenticated")}}async getTemplate(t){try{let{stdout:n}=await this.exec(["get","template",t],{resetVaultTimeout:!0});return{result:JSON.parse(n)}}catch(n){j("Failed to get template",n);let{error:i}=await this.handleCommonErrors(n);if(!i)throw n;return{error:i}}}async encode(t){try{let{stdout:n}=await this.exec(["encode"],{input:t,resetVaultTimeout:!1});return{result:n}}catch(n){j("Failed to encode",n);let{error:i}=await this.handleCommonErrors(n);if(!i)throw n;return{error:i}}}async generatePassword(t,n){let i=t?Xa(t):[],{stdout:a}=await this.exec(["generate",...i],{abortController:n,resetVaultTimeout:!1});return a}async listSends(){try{let{stdout:t}=await this.exec(["send","list"],{resetVaultTimeout:!0});return{result:JSON.parse(t)}}catch(t){j("Failed to list sends",t);let{error:n}=await this.handleCommonErrors(t);if(!n)throw t;return{error:n}}}async createSend(t){try{let{error:n,result:i}=await this.getTemplate(t.type===0?"send.text":"send.file");if(n)throw n;let a=eu(i,t),{result:l,error:c}=await this.encode(JSON.stringify(a));if(c)throw c;let{stdout:y}=await this.exec(["send","create",l],{resetVaultTimeout:!0});return{result:JSON.parse(y)}}catch(n){j("Failed to create send",n);let{error:i}=await this.handleCommonErrors(n);if(!i)throw n;return{error:i}}}async editSend(t){try{let{result:n,error:i}=await this.encode(JSON.stringify(t));if(i)throw i;let{stdout:a}=await this.exec(["send","edit",n],{resetVaultTimeout:!0});return{result:JSON.parse(a)}}catch(n){j("Failed to delete send",n);let{error:i}=await this.handleCommonErrors(n);if(!i)throw n;return{error:i}}}async deleteSend(t){try{return await this.exec(["send","delete",t],{resetVaultTimeout:!0}),{result:void 0}}catch(n){j("Failed to delete send",n);let{error:i}=await this.handleCommonErrors(n);if(!i)throw n;return{error:i}}}async removeSendPassword(t){try{return await this.exec(["send","remove-password",t],{resetVaultTimeout:!0}),{result:void 0}}catch(n){j("Failed to remove send password",n);let{error:i}=await this.handleCommonErrors(n);if(!i)throw n;return{error:i}}}async receiveSendInfo(t,n){try{let{stdout:i,stderr:a}=await this.exec(["send","receive",t,"--obj"],{resetVaultTimeout:!0,input:n?.password});return!i&&/Invalid password/i.test(a)?{error:new _r}:!i&&/Send password/i.test(a)?{error:new wr}:{result:JSON.parse(i)}}catch(i){let a=i.stderr;if(/Invalid password/gi.test(a))return{error:new _r};if(/Send password/gi.test(a))return{error:new wr};j("Failed to receive send obj",i);let{error:l}=await this.handleCommonErrors(i);if(!l)throw i;return{error:l}}}async receiveSend(t,n){try{let{savePath:i,password:a}=n??{},l=["send","receive",t];i&&l.push("--output",i);let{stdout:c}=await this.exec(l,{resetVaultTimeout:!0,input:a});return{result:c}}catch(i){j("Failed to receive send",i);let{error:a}=await this.handleCommonErrors(i);if(!a)throw i;return{error:a}}}async saveLastVaultStatus(t,n){await Z.LocalStorage.setItem(ee.VAULT_LAST_STATUS,n)}async getLastSavedVaultStatus(){let t=await Z.LocalStorage.getItem(ee.VAULT_LAST_STATUS);return t||(await this.status()).result?.status}isPromptWaitingForMasterPassword(t){return!!(t.stderr&&t.stderr.includes("Master password"))}async handlePostLogout(t){this.clearSessionToken(),await this.callActionListeners("logout",t)}async handleCommonErrors(t){let n=t.stderr;return n?/not logged in/i.test(n)?(await this.handlePostLogout(),{error:new Sr("Not logged in")}):/Premium status/i.test(n)?{error:new wn}:{}:{}}setActionListener(t,n){let i=this.actionListeners.get(t);return i&&i.size>0?i.add(n):this.actionListeners.set(t,new Set([n])),this}removeActionListener(t,n){let i=this.actionListeners.get(t);return i&&i.size>0&&i.delete(n),this}async callActionListeners(t,...n){let i=this.actionListeners.get(t);if(i&&i.size>0)for(let a of i)try{await a?.(...n)}catch(l){j(`Error calling bitwarden action listener for ${t}`,l)}}};var _e=require("@raycast/api");var ou=require("child_process"),iu=require("util");var ey=(0,iu.promisify)(ou.exec),ri={getSavedSession:()=>Promise.all([_e.LocalStorage.getItem(ee.SESSION_TOKEN),_e.LocalStorage.getItem(ee.REPROMPT_HASH),_e.LocalStorage.getItem(ee.LAST_ACTIVITY_TIME),_e.LocalStorage.getItem(ee.VAULT_LAST_STATUS)]),clearSession:async()=>{await Promise.all([_e.LocalStorage.removeItem(ee.SESSION_TOKEN),_e.LocalStorage.removeItem(ee.REPROMPT_HASH)])},saveSession:async(o,t)=>{await Promise.all([_e.LocalStorage.setItem(ee.SESSION_TOKEN,o),_e.LocalStorage.setItem(ee.REPROMPT_HASH,t)])},logoutClearSession:async()=>{await Promise.all([_e.LocalStorage.removeItem(ee.SESSION_TOKEN),_e.LocalStorage.removeItem(ee.REPROMPT_HASH),_e.LocalStorage.removeItem(ee.LAST_ACTIVITY_TIME)])}};async function Fd(){let o=await(0,Oe.showToast)(Oe.Toast.Style.Animated,"Locking vault...","Please wait");try{let[t]=await ri.getSavedSession();if(!t){o.style=Oe.Toast.Style.Failure,o.title="No session found",o.message="Already locked or not logged in";return}await(await new Bn(o).initialize()).withSession(t).lock({reason:Qa.MANUAL})}catch{await(0,Oe.showToast)(Oe.Toast.Style.Failure,"Failed to lock vault")}try{await ri.clearSession(),o.style=Oe.Toast.Style.Success,o.title="Vault successfully locked",o.message=void 0}catch{await(0,Oe.showToast)(Oe.Toast.Style.Failure,"Failed to lock vault")}}var Bd=Fd;
/*! Bundled license information:

node-stream-zip/node_stream_zip.js:
  (**
   * @license node-stream-zip | (c) 2020 Antelle | https://github.com/antelle/node-stream-zip/blob/master/LICENSE
   * Portions copyright https://github.com/cthackers/adm-zip | https://raw.githubusercontent.com/cthackers/adm-zip/master/LICENSE
   *)

web-streams-polyfill/dist/ponyfill.es2018.js:
  (**
   * @license
   * web-streams-polyfill v3.3.2
   * Copyright 2024 Mattias Buelens, Diwank Singh Tomer and other contributors.
   * This code is released under the MIT license.
   * SPDX-License-Identifier: MIT
   *)

fetch-blob/index.js:
  (*! fetch-blob. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> *)

formdata-polyfill/esm.min.js:
  (*! formdata-polyfill. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> *)

node-domexception/index.js:
  (*! node-domexception. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> *)
*/
